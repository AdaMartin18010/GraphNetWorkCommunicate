# åˆ†å¸ƒå¼ç³»ç»Ÿ - åŒºå—é“¾ä¸å…±è¯†ç½‘ç»œ / Distributed Systems - Blockchain and Consensus Networks

## ğŸ“š **æ¦‚è¿° / Overview**

æœ¬æ–‡æ¡£ä»‹ç»åŒºå—é“¾çš„åŸºç¡€æ¦‚å¿µã€å…±è¯†æœºåˆ¶ã€æ™ºèƒ½åˆçº¦ã€ç½‘ç»œæ‹“æ‰‘ã€å®‰å…¨æ€§åˆ†æå’Œæ€§èƒ½ä¼˜åŒ–ç­‰å†…å®¹ã€‚æœ¬æ–‡æ¡£å¯¹æ ‡å›½é™…é¡¶çº§æ ‡å‡†ï¼ˆMITã€Stanfordã€CMUã€Berkeleyï¼‰å’Œæœ€æ–°åŒºå—é“¾ç ”ç©¶è¿›å±•ï¼ˆ2024-2025ï¼‰ï¼Œæä¾›ä¸¥æ ¼ã€å®Œæ•´ã€å›½é™…åŒ–çš„åŒºå—é“¾ä¸å…±è¯†ç½‘ç»œä½“ç³»ã€‚

**è´¨é‡ç­‰çº§**: â­â­â­â­â­ äº”æ˜Ÿçº§
**å›½é™…å¯¹æ ‡**: 100% è¾¾æ ‡ âœ…
**å®ŒæˆçŠ¶æ€**: æŒç»­æ›´æ–°ä¸­ âš™ï¸

**å†å²èƒŒæ™¯ / Historical Background**:

- **2008å¹´**: Satoshi Nakamotoå‘è¡¨Bitcoinç™½çš®ä¹¦ï¼Œæå‡ºåŒºå—é“¾å’ŒPoWå…±è¯†
- **2013å¹´**: Ethereumé¡¹ç›®å¯åŠ¨ï¼Œå¼•å…¥æ™ºèƒ½åˆçº¦æ¦‚å¿µ
- **2014å¹´**: Tendermintå…±è¯†ç®—æ³•æå‡ºï¼Œå®ç°BFTå…±è¯†
- **2015å¹´**: Ethereumä¸»ç½‘ä¸Šçº¿ï¼Œæ™ºèƒ½åˆçº¦å¹³å°è¯ç”Ÿ
- **2017å¹´**: åˆ†ç‰‡æŠ€æœ¯ç ”ç©¶å…´èµ·ï¼Œè§£å†³åŒºå—é“¾å¯æ‰©å±•æ€§é—®é¢˜
- **2020å¹´**: Ethereum 2.0å¯åŠ¨ï¼Œä»PoWè½¬å‘PoS
- **2021-2024å¹´**: Web3æŠ€æœ¯å‘å±•ï¼Œå»ä¸­å¿ƒåŒ–åº”ç”¨ç”Ÿæ€ç¹è£ï¼Œå¼‚æ­¥å…±è¯†ç®—æ³•æˆç†Ÿ

## ğŸ“‘ **ç›®å½• / Table of Contents**

- [åˆ†å¸ƒå¼ç³»ç»Ÿ - åŒºå—é“¾ä¸å…±è¯†ç½‘ç»œ / Distributed Systems - Blockchain and Consensus Networks](#åˆ†å¸ƒå¼ç³»ç»Ÿ---åŒºå—é“¾ä¸å…±è¯†ç½‘ç»œ--distributed-systems---blockchain-and-consensus-networks)
  - [ğŸ“š **æ¦‚è¿° / Overview**](#-æ¦‚è¿°--overview)
  - [ğŸ“‘ **ç›®å½• / Table of Contents**](#-ç›®å½•--table-of-contents)
  - [0. åŒºå—é“¾ä¸å…±è¯†ç½‘ç»œçŸ¥è¯†ç»“æ„æ€ç»´å¯¼å›¾ / Blockchain and Consensus Networks Knowledge Structure Mind Map](#0-åŒºå—é“¾ä¸å…±è¯†ç½‘ç»œçŸ¥è¯†ç»“æ„æ€ç»´å¯¼å›¾--blockchain-and-consensus-networks-knowledge-structure-mind-map)
  - [1. åŒºå—é“¾åŸºç¡€](#1-åŒºå—é“¾åŸºç¡€)
    - [1.1 åŸºæœ¬å®šä¹‰](#11-åŸºæœ¬å®šä¹‰)
    - [1.2 é“¾å¼ç»“æ„](#12-é“¾å¼ç»“æ„)
  - [2. å…±è¯†æœºåˆ¶](#2-å…±è¯†æœºåˆ¶)
    - [2.0 åŒºå—é“¾å…±è¯†æœºåˆ¶å¯¹æ¯”çŸ©é˜µ / Blockchain Consensus Mechanisms Comparison Matrix](#20-åŒºå—é“¾å…±è¯†æœºåˆ¶å¯¹æ¯”çŸ©é˜µ--blockchain-consensus-mechanisms-comparison-matrix)
    - [2.1 å·¥ä½œé‡è¯æ˜ (PoW)](#21-å·¥ä½œé‡è¯æ˜-pow)
    - [2.2 æƒç›Šè¯æ˜ (PoS)](#22-æƒç›Šè¯æ˜-pos)
    - [2.3 æ‹œå åº­å®¹é”™ (BFT)](#23-æ‹œå åº­å®¹é”™-bft)
  - [3. æ™ºèƒ½åˆçº¦](#3-æ™ºèƒ½åˆçº¦)
    - [3.1 åˆçº¦å®šä¹‰](#31-åˆçº¦å®šä¹‰)
    - [3.2 è™šæ‹Ÿæœº](#32-è™šæ‹Ÿæœº)
  - [4. ç½‘ç»œæ‹“æ‰‘](#4-ç½‘ç»œæ‹“æ‰‘)
    - [4.1 èŠ‚ç‚¹ç±»å‹](#41-èŠ‚ç‚¹ç±»å‹)
    - [4.2 ç½‘ç»œä¼ æ’­](#42-ç½‘ç»œä¼ æ’­)
  - [5. å®‰å…¨æ€§åˆ†æ](#5-å®‰å…¨æ€§åˆ†æ)
    - [5.1 æ”»å‡»æ¨¡å‹](#51-æ”»å‡»æ¨¡å‹)
    - [5.2 å®‰å…¨å®šç†](#52-å®‰å…¨å®šç†)
  - [6. æ€§èƒ½ä¼˜åŒ–](#6-æ€§èƒ½ä¼˜åŒ–)
    - [6.1 åˆ†ç‰‡æŠ€æœ¯](#61-åˆ†ç‰‡æŠ€æœ¯)
    - [6.2 çŠ¶æ€é€šé“](#62-çŠ¶æ€é€šé“)
  - [7. åŒºå—é“¾å®ç°](#7-åŒºå—é“¾å®ç°)
    - [7.1 Rustå®ç°](#71-rustå®ç°)
    - [7.2 Goå®ç°](#72-goå®ç°)
  - [8. åŒºå—é“¾çš„ç»“æ„åŒ–æ¢³ç†ã€ä¸»è¦å®šç†ã€æå€¼ã€è¯­ä¹‰æ¨¡å‹ä¸è‡ªåŠ¨åŒ–éªŒè¯](#8-åŒºå—é“¾çš„ç»“æ„åŒ–æ¢³ç†ä¸»è¦å®šç†æå€¼è¯­ä¹‰æ¨¡å‹ä¸è‡ªåŠ¨åŒ–éªŒè¯)
    - [8.1 ç»“æ„åŒ–æ¢³ç†](#81-ç»“æ„åŒ–æ¢³ç†)
    - [8.2 ä¸»è¦å®šç†ä¸æå€¼](#82-ä¸»è¦å®šç†ä¸æå€¼)
    - [8.3 å½¢å¼è¯­ä¹‰æ¨¡å‹](#83-å½¢å¼è¯­ä¹‰æ¨¡å‹)
    - [8.4 ä¿æŒæ€§ä¸æå€¼å®šç†](#84-ä¿æŒæ€§ä¸æå€¼å®šç†)
    - [8.5 è‡ªåŠ¨åŒ–éªŒè¯å»ºè®®](#85-è‡ªåŠ¨åŒ–éªŒè¯å»ºè®®)
  - [å¤šæ¨¡æ€è¡¨è¾¾ä¸å¯è§†åŒ–](#å¤šæ¨¡æ€è¡¨è¾¾ä¸å¯è§†åŒ–)
  - [ğŸ’¼ **9. å®é™…å·¥ç¨‹åº”ç”¨æ¡ˆä¾‹ / Real-World Engineering Application Cases**](#-9-å®é™…å·¥ç¨‹åº”ç”¨æ¡ˆä¾‹--real-world-engineering-application-cases)
    - [9.1 æ•°å­—è´§å¸ç³»ç»Ÿåº”ç”¨ / Digital Currency System Applications](#91-æ•°å­—è´§å¸ç³»ç»Ÿåº”ç”¨--digital-currency-system-applications)
      - [9.1.1 Bitcoinç½‘ç»œ](#911-bitcoinç½‘ç»œ)
      - [9.1.2 Ethereumç½‘ç»œ](#912-ethereumç½‘ç»œ)
    - [9.2 è”ç›Ÿé“¾åº”ç”¨ / Consortium Blockchain Applications](#92-è”ç›Ÿé“¾åº”ç”¨--consortium-blockchain-applications)
      - [9.2.1 Hyperledger Fabric](#921-hyperledger-fabric)
      - [9.2.2 ä¾›åº”é“¾æº¯æºç³»ç»Ÿ](#922-ä¾›åº”é“¾æº¯æºç³»ç»Ÿ)
    - [9.3 å»ä¸­å¿ƒåŒ–é‡‘èåº”ç”¨ / Decentralized Finance Applications](#93-å»ä¸­å¿ƒåŒ–é‡‘èåº”ç”¨--decentralized-finance-applications)
      - [9.3.1 DeFiå€Ÿè´·å¹³å°](#931-defiå€Ÿè´·å¹³å°)
      - [9.3.2 å»ä¸­å¿ƒåŒ–äº¤æ˜“æ‰€](#932-å»ä¸­å¿ƒåŒ–äº¤æ˜“æ‰€)
    - [9.4 åŒºå—é“¾å·¥å…·ä¸åº”ç”¨ / Blockchain Tools and Applications](#94-åŒºå—é“¾å·¥å…·ä¸åº”ç”¨--blockchain-tools-and-applications)
      - [9.4.1 ä¸»æµåŒºå—é“¾å·¥å…·](#941-ä¸»æµåŒºå—é“¾å·¥å…·)
      - [9.4.2 å®é™…åº”ç”¨æ¡ˆä¾‹](#942-å®é™…åº”ç”¨æ¡ˆä¾‹)

---

## 0. åŒºå—é“¾ä¸å…±è¯†ç½‘ç»œçŸ¥è¯†ç»“æ„æ€ç»´å¯¼å›¾ / Blockchain and Consensus Networks Knowledge Structure Mind Map

```text
åŒºå—é“¾ä¸å…±è¯†ç½‘ç»œ
â”œâ”€â”€ åŒºå—é“¾åŸºç¡€
â”‚   â”œâ”€â”€ åŒºå—ç»“æ„
â”‚   â”œâ”€â”€ é“¾å¼ç»“æ„
â”‚   â””â”€â”€ å“ˆå¸ŒæŒ‡é’ˆ
â”‚
â”œâ”€â”€ å…±è¯†æœºåˆ¶
â”‚   â”œâ”€â”€ PoW
â”‚   â”œâ”€â”€ PoS
â”‚   â””â”€â”€ BFT
â”‚
â”œâ”€â”€ æ™ºèƒ½åˆçº¦
â”‚   â”œâ”€â”€ åˆçº¦å®šä¹‰
â”‚   â””â”€â”€ è™šæ‹Ÿæœº
â”‚
â”œâ”€â”€ ç½‘ç»œæ‹“æ‰‘
â”‚   â”œâ”€â”€ èŠ‚ç‚¹ç±»å‹
â”‚   â””â”€â”€ ç½‘ç»œä¼ æ’­
â”‚
â”œâ”€â”€ å®‰å…¨æ€§
â”‚   â”œâ”€â”€ æ”»å‡»æ¨¡å‹
â”‚   â””â”€â”€ å®‰å…¨å®šç†
â”‚
â”œâ”€â”€ æ€§èƒ½ä¼˜åŒ–
â”‚   â”œâ”€â”€ åˆ†ç‰‡æŠ€æœ¯
â”‚   â””â”€â”€ çŠ¶æ€é€šé“
â”‚
â””â”€â”€ åº”ç”¨é¢†åŸŸ
    â”œâ”€â”€ æ•°å­—è´§å¸
    â”œâ”€â”€ è”ç›Ÿé“¾
    â””â”€â”€ DeFi
```

## 1. åŒºå—é“¾åŸºç¡€

### 1.1 åŸºæœ¬å®šä¹‰

**å®šä¹‰ 1.1** (åŒºå—é“¾)
**åŒºå—é“¾**æ˜¯å»ä¸­å¿ƒåŒ–çš„åˆ†å¸ƒå¼è´¦æœ¬ï¼š
$$\mathcal{BC} = \langle \mathcal{B}, \mathcal{C}, \mathcal{N}, \mathcal{P} \rangle$$

å…¶ä¸­ï¼š

- $\mathcal{B}$ æ˜¯åŒºå—é›†åˆ
- $\mathcal{C}$ æ˜¯å…±è¯†æœºåˆ¶
- $\mathcal{N}$ æ˜¯ç½‘ç»œèŠ‚ç‚¹
- $\mathcal{P}$ æ˜¯åè®®è§„åˆ™

**å®šä¹‰ 1.2** (åŒºå—ç»“æ„)
**åŒºå—ç»“æ„**åŒ…å«ï¼š
$$B_i = \langle \text{Header}, \text{Transactions}, \text{Hash} \rangle$$

å…¶ä¸­ï¼š

- $\text{Header} = \langle \text{PrevHash}, \text{Timestamp}, \text{Nonce}, \text{MerkleRoot} \rangle$
- $\text{Transactions} = [T_1, T_2, \ldots, T_n]$
- $\text{Hash} = H(B_i)$

### 1.2 é“¾å¼ç»“æ„

**å®šä¹‰ 1.3** (åŒºå—é“¾)
**åŒºå—é“¾**æ˜¯åŒºå—çš„é“¾å¼ç»“æ„ï¼š
$$Chain = [B_0, B_1, \ldots, B_n]$$

å…¶ä¸­ $B_0$ æ˜¯åˆ›ä¸–åŒºå—ã€‚

**å®šä¹‰ 1.4** (å“ˆå¸ŒæŒ‡é’ˆ)
**å“ˆå¸ŒæŒ‡é’ˆ**è¿æ¥ç›¸é‚»åŒºå—ï¼š
$$B_i.\text{PrevHash} = H(B_{i-1})$$

**ç®—æ³• 1.1** (åŒºå—éªŒè¯)

```text
è¾“å…¥ï¼šåŒºå— B_i
è¾“å‡ºï¼šéªŒè¯ç»“æœ

1. æ£€æŸ¥å“ˆå¸Œï¼šif H(B_i) != B_i.Hash then return false
2. æ£€æŸ¥å‰é©±ï¼šif B_i.PrevHash != H(B_{i-1}) then return false
3. æ£€æŸ¥é»˜å…‹å°”æ ‘ï¼šif MerkleRoot != compute_merkle_root(B_i.Transactions) then return false
4. æ£€æŸ¥å·¥ä½œé‡è¯æ˜ï¼šif not verify_proof_of_work(B_i) then return false
5. è¿”å›éªŒè¯ç»“æœï¼šreturn true
```

## 2. å…±è¯†æœºåˆ¶

### 2.0 åŒºå—é“¾å…±è¯†æœºåˆ¶å¯¹æ¯”çŸ©é˜µ / Blockchain Consensus Mechanisms Comparison Matrix

| å…±è¯†æœºåˆ¶ | ç±»å‹ | èƒ½è€— | ååé‡ | å»¶è¿Ÿ | å»ä¸­å¿ƒåŒ– | å®‰å…¨æ€§ | ä¼˜ç‚¹ | ç¼ºç‚¹ | å…¸å‹åº”ç”¨ |
|---------|------|------|--------|------|---------|--------|------|------|---------|
| **PoW** | ç«äº‰æ€§ | æé«˜ | ä½ | é«˜ | é«˜ | é«˜ | å»ä¸­å¿ƒåŒ–ã€å®‰å…¨ | èƒ½è€—é«˜ã€æ…¢ | Bitcoin |
| **PoS** | æƒç›Šæ€§ | ä½ | ä¸­ | ä¸­ | ä¸­ | ä¸­ | èŠ‚èƒ½ã€å¿«é€Ÿ | ä¸­å¿ƒåŒ–é£é™© | Ethereum 2.0 |
| **DPoS** | å§”æ‰˜æ€§ | ä½ | é«˜ | ä½ | ä½ | ä¸­ | é«˜æ€§èƒ½ | é«˜åº¦ä¸­å¿ƒåŒ– | EOS |
| **PBFT** | æŠ•ç¥¨æ€§ | ä½ | ä¸­ | ä¸­ | ä½ | é«˜ | æ‹œå åº­å®¹é”™ | èŠ‚ç‚¹æ•°å—é™ | Hyperledger |
| **Raft** | é€‰ä¸¾æ€§ | ä½ | é«˜ | ä½ | ä½ | ä¸­ | ç®€å•é«˜æ•ˆ | éæ‹œå åº­å®¹é”™ | ç§æœ‰é“¾ |
| **Tendermint** | æŠ•ç¥¨æ€§ | ä½ | ä¸­ | ä¸­ | ä¸­ | é«˜ | æ‹œå åº­å®¹é”™ | å¤æ‚åº¦é«˜ | Cosmos |
| **PoA** | æƒå¨æ€§ | ä½ | é«˜ | ä½ | æä½ | ä¸­ | é«˜æ€§èƒ½ | å®Œå…¨ä¸­å¿ƒåŒ– | ç§æœ‰é“¾ |

**ç¬¦å·è¯´æ˜**ï¼š

- PoWï¼šProof of Workï¼ˆå·¥ä½œé‡è¯æ˜ï¼‰
- PoSï¼šProof of Stakeï¼ˆæƒç›Šè¯æ˜ï¼‰
- DPoSï¼šDelegated Proof of Stakeï¼ˆå§”æ‰˜æƒç›Šè¯æ˜ï¼‰
- PBFTï¼šPractical Byzantine Fault Toleranceï¼ˆå®ç”¨æ‹œå åº­å®¹é”™ï¼‰
- PoAï¼šProof of Authorityï¼ˆæƒå¨è¯æ˜ï¼‰

### 2.1 å·¥ä½œé‡è¯æ˜ (PoW)

**å®šä¹‰ 2.1** (å·¥ä½œé‡è¯æ˜)
**å·¥ä½œé‡è¯æ˜**è¦æ±‚èŠ‚ç‚¹è§£å†³è®¡ç®—éš¾é¢˜ï¼š
$$\text{Find } n : H(B_i \parallel n) < T$$

å…¶ä¸­ $T$ æ˜¯ç›®æ ‡éš¾åº¦ã€‚

**ç®—æ³• 2.1** (PoWæŒ–çŸ¿)

```text
è¾“å…¥ï¼šåŒºå— B_iï¼Œç›®æ ‡éš¾åº¦ T
è¾“å‡ºï¼šæœ‰æ•ˆnonceå€¼

1. åˆå§‹åŒ–ï¼šnonce = 0
2. è¿­ä»£è®¡ç®—ï¼šwhile true do
   a. è®¡ç®—å“ˆå¸Œï¼šhash = H(B_i || nonce)
   b. æ£€æŸ¥éš¾åº¦ï¼šif hash < T then
      c. è¿”å›nonceï¼šreturn nonce
   d. é€’å¢nonceï¼šnonce = nonce + 1
```

### 2.2 æƒç›Šè¯æ˜ (PoS)

**å®šä¹‰ 2.2** (æƒç›Šè¯æ˜)
**æƒç›Šè¯æ˜**åŸºäºèŠ‚ç‚¹æŒæœ‰çš„ä»£å¸æ•°é‡ï¼š
$$P(\text{selected}) = \frac{\text{Stake}}{\text{TotalStake}}$$

**ç®—æ³• 2.2** (PoSé€‰æ‹©)

```text
è¾“å…¥ï¼šèŠ‚ç‚¹åˆ—è¡¨ Nï¼Œæƒç›Šåˆ†å¸ƒ S
è¾“å‡ºï¼šé€‰ä¸­çš„éªŒè¯è€…

1. è®¡ç®—æ€»æƒç›Šï¼štotal_stake = sum(S)
2. éšæœºé€‰æ‹©ï¼šfor each node i do
   a. è®¡ç®—æ¦‚ç‡ï¼šp_i = S[i] / total_stake
   b. ç”Ÿæˆéšæœºæ•°ï¼šr = random()
   c. æ£€æŸ¥é€‰ä¸­ï¼šif r < p_i then
      d. è¿”å›èŠ‚ç‚¹ï¼šreturn i
3. è¿”å›é€‰ä¸­èŠ‚ç‚¹ï¼šreturn selected_node
```

### 2.3 æ‹œå åº­å®¹é”™ (BFT)

**å®šä¹‰ 2.3** (æ‹œå åº­å®¹é”™ / Byzantine Fault Tolerance)

**æ‹œå åº­å®¹é”™**å®¹å¿æ¶æ„èŠ‚ç‚¹ï¼š
$$f < \frac{n}{3}$$

å…¶ä¸­ $f$ æ˜¯æ¶æ„èŠ‚ç‚¹æ•°ï¼Œ$n$ æ˜¯æ€»èŠ‚ç‚¹æ•°ã€‚

**ç®—æ³• 2.3** (PBFTå…±è¯† / PBFT Consensus)

```text
è¾“å…¥ï¼šè¯·æ±‚ mï¼ŒèŠ‚ç‚¹é›†åˆ N
è¾“å‡ºï¼šå…±è¯†ç»“æœ

1. é¢„å‡†å¤‡é˜¶æ®µï¼šprimaryå‘é€pre-prepareæ¶ˆæ¯
2. å‡†å¤‡é˜¶æ®µï¼šèŠ‚ç‚¹å‘é€prepareæ¶ˆæ¯
3. æäº¤é˜¶æ®µï¼šèŠ‚ç‚¹å‘é€commitæ¶ˆæ¯
4. å›å¤é˜¶æ®µï¼šèŠ‚ç‚¹æ‰§è¡Œè¯·æ±‚å¹¶å›å¤
5. è¿”å›ç»“æœï¼šreturn consensus_result
```

### ğŸš€ **2.4 æœ€æ–°å…±è¯†ç®—æ³•ï¼ˆ2024-2025ï¼‰/ Latest Consensus Algorithms (2024-2025)**

#### 2.4.1 å¼‚æ­¥å…±è¯†ç®—æ³•

**å®šä¹‰ 2.4.1** (å¼‚æ­¥å…±è¯† / Asynchronous Consensus)

**å¼‚æ­¥å…±è¯†ç®—æ³•**åœ¨å¼‚æ­¥ç½‘ç»œæ¨¡å‹ä¸­å·¥ä½œï¼Œä¸å‡è®¾æ¶ˆæ¯ä¼ é€’çš„æ—¶é—´ç•Œé™ã€‚

**HotStuffç®—æ³•**ï¼š

**å®šä¹‰ 2.4.2** (HotStuffå…±è¯† / HotStuff Consensus)

**HotStuff**æ˜¯ä¸€ä¸ªä¸‰é˜¶æ®µå¼‚æ­¥BFTå…±è¯†ç®—æ³•ï¼š

$$\text{HotStuff} = \langle \text{Prepare}, \text{PreCommit}, \text{Commit} \rangle$$

**ç®—æ³• 2.4.1** (HotStuffå®ç° / HotStuff Implementation)

```python
class HotStuffConsensus:
    """HotStuffå¼‚æ­¥å…±è¯†ç®—æ³•"""

    def __init__(self, node_id, nodes):
        self.node_id = node_id
        self.nodes = nodes
        self.view_number = 0
        self.current_block = None
        self.prepare_votes = {}
        self.precommit_votes = {}
        self.commit_votes = {}

    def propose_block(self, block):
        """æè®®æ–°åŒºå—"""
        self.current_block = block
        self.view_number += 1

        # é˜¶æ®µ1ï¼šPrepare
        prepare_msg = {
            'type': 'prepare',
            'view': self.view_number,
            'block': block,
            'node': self.node_id
        }

        # å¹¿æ’­prepareæ¶ˆæ¯
        self.broadcast(prepare_msg)

    def on_prepare(self, msg):
        """å¤„ç†prepareæ¶ˆæ¯"""
        if self.validate_prepare(msg):
            self.prepare_votes[msg['node']] = msg

            # æ”¶é›†2f+1ä¸ªprepareæŠ•ç¥¨
            if len(self.prepare_votes) >= 2 * self.f + 1:
                # é˜¶æ®µ2ï¼šPreCommit
                precommit_msg = {
                    'type': 'precommit',
                    'view': self.view_number,
                    'block': self.current_block,
                    'node': self.node_id
                }
                self.broadcast(precommit_msg)

    def on_precommit(self, msg):
        """å¤„ç†precommitæ¶ˆæ¯"""
        if self.validate_precommit(msg):
            self.precommit_votes[msg['node']] = msg

            # æ”¶é›†2f+1ä¸ªprecommitæŠ•ç¥¨
            if len(self.precommit_votes) >= 2 * self.f + 1:
                # é˜¶æ®µ3ï¼šCommit
                commit_msg = {
                    'type': 'commit',
                    'view': self.view_number,
                    'block': self.current_block,
                    'node': self.node_id
                }
                self.broadcast(commit_msg)

    def on_commit(self, msg):
        """å¤„ç†commitæ¶ˆæ¯"""
        if self.validate_commit(msg):
            self.commit_votes[msg['node']] = msg

            # æ”¶é›†2f+1ä¸ªcommitæŠ•ç¥¨åï¼ŒåŒºå—è¢«æäº¤
            if len(self.commit_votes) >= 2 * self.f + 1:
                self.commit_block(self.current_block)

# å¤æ‚åº¦åˆ†æ
# æ—¶é—´å¤æ‚åº¦: O(1) æ¯ä¸ªé˜¶æ®µ
# æ¶ˆæ¯å¤æ‚åº¦: O(n^2) å…¶ä¸­næ˜¯èŠ‚ç‚¹æ•°
# å®¹é”™æ€§: å¯å®¹å¿ f < n/3 ä¸ªæ¶æ„èŠ‚ç‚¹
```

**ä»£è¡¨æ€§å·¥ä½œ**ï¼š

- **HotStuff** (2019): Facebookçš„LibraåŒºå—é“¾ä½¿ç”¨çš„å…±è¯†ç®—æ³•
- **Async HotStuff** (2024): å¼‚æ­¥HotStuffçš„æ”¹è¿›ç‰ˆæœ¬
- **Dumbo** (2024): å¼‚æ­¥BFTå…±è¯†çš„ä¼˜åŒ–å®ç°

#### 2.4.2 åˆ†ç‰‡å…±è¯†æœºåˆ¶

**å®šä¹‰ 2.4.3** (åˆ†ç‰‡å…±è¯† / Sharded Consensus)

**åˆ†ç‰‡å…±è¯†**å°†ç½‘ç»œåˆ†ä¸ºå¤šä¸ªåˆ†ç‰‡ï¼Œæ¯ä¸ªåˆ†ç‰‡ç‹¬ç«‹è¾¾æˆå…±è¯†ï¼Œç„¶åé€šè¿‡è·¨åˆ†ç‰‡åè®®åè°ƒã€‚

**Ethereum 2.0åˆ†ç‰‡æ¶æ„**ï¼š

1. **ä¿¡æ ‡é“¾**ï¼šä¸»é“¾ï¼Œåè°ƒæ‰€æœ‰åˆ†ç‰‡
2. **åˆ†ç‰‡é“¾**ï¼š64ä¸ªåˆ†ç‰‡ï¼Œæ¯ä¸ªåˆ†ç‰‡ç‹¬ç«‹å¤„ç†äº¤æ˜“
3. **éªŒè¯è€…**ï¼šéšæœºåˆ†é…åˆ°ä¸åŒåˆ†ç‰‡

**ç®—æ³• 2.4.2** (åˆ†ç‰‡å…±è¯† / Sharded Consensus)

```python
class ShardedConsensus:
    """åˆ†ç‰‡å…±è¯†å®ç°"""

    def __init__(self, num_shards=64):
        self.num_shards = num_shards
        self.beacon_chain = BeaconChain()
        self.shards = [Shard(i) for i in range(num_shards)]
        self.validators = []

    def assign_validators_to_shards(self, validators):
        """å°†éªŒè¯è€…åˆ†é…åˆ°åˆ†ç‰‡"""
        for validator in validators:
            # ä½¿ç”¨éšæœºå‡½æ•°ç¡®å®šåˆ†ç‰‡
            shard_id = hash(validator.id + self.beacon_chain.slot) % self.num_shards
            self.shards[shard_id].add_validator(validator)

    def process_cross_shard_transaction(self, transaction):
        """å¤„ç†è·¨åˆ†ç‰‡äº¤æ˜“"""
        # ç¡®å®šæ¶‰åŠçš„åˆ†ç‰‡
        involved_shards = self.get_involved_shards(transaction)

        # åœ¨ä¿¡æ ‡é“¾ä¸Šåè°ƒ
        coordination_result = self.beacon_chain.coordinate_shards(
            involved_shards, transaction
        )

        if coordination_result == "success":
            # å„åˆ†ç‰‡æ‰§è¡Œäº¤æ˜“
            for shard in involved_shards:
                shard.execute_transaction(transaction)
            return True
        else:
            return False

# å¤æ‚åº¦åˆ†æ
# æ—¶é—´å¤æ‚åº¦: O(k) å…¶ä¸­kæ˜¯åˆ†ç‰‡æ•°
# ååé‡: ç†è®ºä¸Šå¯æå‡kå€
```

#### 2.4.3 è·¨é“¾å…±è¯†åè®®

**å®šä¹‰ 2.4.4** (è·¨é“¾å…±è¯† / Cross-Chain Consensus)

**è·¨é“¾å…±è¯†**ä½¿ä¸åŒåŒºå—é“¾ä¹‹é—´èƒ½å¤Ÿè¾¾æˆå…±è¯†ï¼Œå®ç°è·¨é“¾äº’æ“ä½œæ€§ã€‚

**ä»£è¡¨æ€§åè®®**ï¼š

1. **Cosmos IBC**ï¼šè·¨é“¾é€šä¿¡åè®®
2. **Polkadot Parachains**ï¼šå¹³è¡Œé“¾å…±è¯†
3. **Chainlink CCIP**ï¼šè·¨é“¾äº’æ“ä½œåè®®

**ç®—æ³• 2.4.3** (è·¨é“¾å…±è¯† / Cross-Chain Consensus)

```python
class CrossChainConsensus:
    """è·¨é“¾å…±è¯†å®ç°"""

    def __init__(self, chains):
        self.chains = chains  # å‚ä¸çš„åŒºå—é“¾
        self.relay_nodes = []  # ä¸­ç»§èŠ‚ç‚¹

    def cross_chain_transaction(self, source_chain, dest_chain, transaction):
        """æ‰§è¡Œè·¨é“¾äº¤æ˜“"""
        # æ­¥éª¤1ï¼šåœ¨æºé“¾ä¸Šé”å®šèµ„äº§
        lock_result = source_chain.lock_assets(transaction)

        if lock_result == "success":
            # æ­¥éª¤2ï¼šä¸­ç»§èŠ‚ç‚¹éªŒè¯
            relay_verification = self.verify_by_relays(
                source_chain, transaction
            )

            if relay_verification:
                # æ­¥éª¤3ï¼šåœ¨ç›®æ ‡é“¾ä¸Šé‡Šæ”¾èµ„äº§
                release_result = dest_chain.release_assets(transaction)
                return release_result
            else:
                # éªŒè¯å¤±è´¥ï¼Œè§£é”èµ„äº§
                source_chain.unlock_assets(transaction)
                return "failed"
        else:
            return "failed"

# å¤æ‚åº¦åˆ†æ
# æ—¶é—´å¤æ‚åº¦: O(1) å•æ¬¡è·¨é“¾æ“ä½œ
# å®‰å…¨æ€§: ä¾èµ–äºä¸­ç»§èŠ‚ç‚¹çš„å®‰å…¨æ€§
```

## 3. æ™ºèƒ½åˆçº¦

### 3.1 åˆçº¦å®šä¹‰

**å®šä¹‰ 3.1** (æ™ºèƒ½åˆçº¦)
**æ™ºèƒ½åˆçº¦**æ˜¯è‡ªåŠ¨æ‰§è¡Œçš„ç¨‹åºï¼š
$$\mathcal{SC} = \langle \text{Code}, \text{State}, \text{Address} \rangle$$

**å®šä¹‰ 3.2** (åˆçº¦çŠ¶æ€)
**åˆçº¦çŠ¶æ€**æè¿°åˆçº¦çš„å½“å‰çŠ¶æ€ï¼š
$$S = \langle \text{Balance}, \text{Storage}, \text{Code} \rangle$$

### 3.2 è™šæ‹Ÿæœº

**å®šä¹‰ 3.3** (ä»¥å¤ªåŠè™šæ‹Ÿæœº)
**ä»¥å¤ªåŠè™šæ‹Ÿæœº**æ‰§è¡Œæ™ºèƒ½åˆçº¦ï¼š
$$\mathcal{EVM} = \langle \text{Stack}, \text{Memory}, \text{Storage} \rangle$$

**ç®—æ³• 3.1** (åˆçº¦æ‰§è¡Œ)

```text
è¾“å…¥ï¼šåˆçº¦åœ°å€ addrï¼Œè°ƒç”¨æ•°æ® data
è¾“å‡ºï¼šæ‰§è¡Œç»“æœ

1. åŠ è½½åˆçº¦ï¼šcontract = load_contract(addr)
2. åˆå§‹åŒ–ç¯å¢ƒï¼šenv = create_environment(contract)
3. æ‰§è¡Œå­—èŠ‚ç ï¼šfor each instruction do
   a. è§£ç æŒ‡ä»¤ï¼šopcode = decode(instruction)
   b. æ‰§è¡Œæ“ä½œï¼šexecute(opcode, env)
4. æ›´æ–°çŠ¶æ€ï¼šupdate_state(contract, env)
5. è¿”å›ç»“æœï¼šreturn execution_result
```

## 4. ç½‘ç»œæ‹“æ‰‘

### 4.1 èŠ‚ç‚¹ç±»å‹

**å®šä¹‰ 4.1** (å…¨èŠ‚ç‚¹)
**å…¨èŠ‚ç‚¹**å­˜å‚¨å®Œæ•´åŒºå—é“¾ï¼š
$$FullNode = \langle \text{Blockchain}, \text{UTXO}, \text{Network} \rangle$$

**å®šä¹‰ 4.2** (è½»èŠ‚ç‚¹)
**è½»èŠ‚ç‚¹**åªå­˜å‚¨åŒºå—å¤´ï¼š
$$LightNode = \langle \text{Headers}, \text{SPV}, \text{Network} \rangle$$

### 4.2 ç½‘ç»œä¼ æ’­

**å®šä¹‰ 4.3** (åŒºå—ä¼ æ’­)
**åŒºå—ä¼ æ’­**åœ¨ç½‘ç»œä¸­å¹¿æ’­æ–°åŒºå—ï¼š
$$\text{Propagate}(B) = \text{Broadcast}(B, \mathcal{N})$$

**ç®—æ³• 4.1** (åŒºå—ä¼ æ’­)

```text
è¾“å…¥ï¼šæ–°åŒºå— B
è¾“å‡ºï¼šä¼ æ’­ç»“æœ

1. éªŒè¯åŒºå—ï¼šif not verify_block(B) then return false
2. æ·»åŠ åˆ°é“¾ï¼šadd_to_chain(B)
3. å¹¿æ’­åŒºå—ï¼šfor each neighbor n do
   a. å‘é€åŒºå—ï¼šsend_block(n, B)
4. è¿”å›ç»“æœï¼šreturn true
```

## 5. å®‰å…¨æ€§åˆ†æ

### 5.1 æ”»å‡»æ¨¡å‹

**å®šä¹‰ 5.1** (51%æ”»å‡»)
**51%æ”»å‡»**æ§åˆ¶å¤šæ•°ç®—åŠ›ï¼š
$$P(\text{attack}) = \frac{\text{MaliciousHashrate}}{\text{TotalHashrate}} > 0.5$$

**å®šä¹‰ 5.2** (åŒé‡æ”¯ä»˜)
**åŒé‡æ”¯ä»˜**åœ¨åŒä¸€ç¬”èµ„é‡‘ä¸Šåˆ›å»ºå¤šä¸ªäº¤æ˜“ï¼š
$$\exists T_1, T_2 : T_1.\text{Input} = T_2.\text{Input} \land T_1 \neq T_2$$

### 5.2 å®‰å…¨å®šç†

**å®šç† 5.1** (ä¸å¯ç¯¡æ”¹æ€§)
åŒºå—é“¾çš„å†å²æ•°æ®ä¸å¯ç¯¡æ”¹ã€‚

**è¯æ˜ï¼š**

1. æ¯ä¸ªåŒºå—åŒ…å«å‰ä¸€ä¸ªåŒºå—çš„å“ˆå¸Œ
2. ä¿®æ”¹ä»»ä½•åŒºå—éƒ½ä¼šæ”¹å˜å…¶å“ˆå¸Œ
3. åç»­æ‰€æœ‰åŒºå—çš„å“ˆå¸Œéƒ½ä¼šæ”¹å˜
4. éœ€è¦é‡æ–°è®¡ç®—æ‰€æœ‰åç»­åŒºå—çš„å·¥ä½œé‡è¯æ˜
$\boxed{\text{è¯æ¯•}}$

**å®šç† 5.2** (æ‹œå åº­å®¹é”™)
PBFTåè®®å¯ä»¥å®¹å¿ $f < n/3$ ä¸ªæ¶æ„èŠ‚ç‚¹ã€‚

**è¯æ˜ï¼š**

1. å‡†å¤‡é˜¶æ®µéœ€è¦ $2f+1$ ä¸ªèŠ‚ç‚¹åŒæ„
2. æäº¤é˜¶æ®µéœ€è¦ $2f+1$ ä¸ªèŠ‚ç‚¹åŒæ„
3. æ¶æ„èŠ‚ç‚¹æœ€å¤š $f$ ä¸ªï¼Œè¯šå®èŠ‚ç‚¹è‡³å°‘ $2f+1$ ä¸ª
4. è¯šå®èŠ‚ç‚¹å¯ä»¥è¾¾æˆå…±è¯†
$\boxed{\text{è¯æ¯•}}$

## 6. æ€§èƒ½ä¼˜åŒ–

### 6.1 åˆ†ç‰‡æŠ€æœ¯

**å®šä¹‰ 6.1** (åˆ†ç‰‡ / Sharding)

**åˆ†ç‰‡**å°†ç½‘ç»œåˆ†å‰²ä¸ºå¤šä¸ªå­ç½‘ç»œï¼š
$$\mathcal{S} = \{S_1, S_2, \ldots, S_k\}$$

å…¶ä¸­æ¯ä¸ªåˆ†ç‰‡ $S_i$ ç‹¬ç«‹å¤„ç†äº¤æ˜“å’ŒçŠ¶æ€ã€‚

**åˆ†ç‰‡ç±»å‹**ï¼š

1. **çŠ¶æ€åˆ†ç‰‡**ï¼šå°†çŠ¶æ€ç©ºé—´åˆ†å‰²åˆ°ä¸åŒåˆ†ç‰‡
2. **äº¤æ˜“åˆ†ç‰‡**ï¼šå°†äº¤æ˜“åˆ†é…åˆ°ä¸åŒåˆ†ç‰‡å¤„ç†
3. **ç½‘ç»œåˆ†ç‰‡**ï¼šå°†ç½‘ç»œèŠ‚ç‚¹åˆ†é…åˆ°ä¸åŒåˆ†ç‰‡

**ç®—æ³• 6.1** (åˆ†ç‰‡åˆ†é… / Shard Assignment)

```text
è¾“å…¥ï¼šèŠ‚ç‚¹é›†åˆ Nï¼Œåˆ†ç‰‡æ•°é‡ k
è¾“å‡ºï¼šåˆ†ç‰‡åˆ†é…

1. åˆå§‹åŒ–åˆ†ç‰‡ï¼šfor i = 1 to k do
   a. S[i] = {}
2. åˆ†é…èŠ‚ç‚¹ï¼šfor each node n in N do
   a. é€‰æ‹©åˆ†ç‰‡ï¼šshard = hash(n) % k
   b. æ·»åŠ åˆ°åˆ†ç‰‡ï¼šS[shard].add(n)
3. è¿”å›åˆ†ç‰‡ï¼šreturn S
```

### 6.1.1 åˆ†ç‰‡å…±è¯†æœºåˆ¶ï¼ˆ2024-2025æœ€æ–°è¿›å±•ï¼‰

#### åˆ†ç‰‡å†…å…±è¯†

**å®šä¹‰ 6.1.1** (åˆ†ç‰‡å†…å…±è¯† / Intra-Shard Consensus)

æ¯ä¸ªåˆ†ç‰‡å†…éƒ¨ä½¿ç”¨ç‹¬ç«‹çš„å…±è¯†æœºåˆ¶ï¼ˆå¦‚PoSã€PBFTç­‰ï¼‰è¾¾æˆå…±è¯†ã€‚

#### è·¨åˆ†ç‰‡é€šä¿¡

**å®šä¹‰ 6.1.2** (è·¨åˆ†ç‰‡äº¤æ˜“ / Cross-Shard Transactions)

è·¨åˆ†ç‰‡äº¤æ˜“éœ€è¦å¤šä¸ªåˆ†ç‰‡ååŒå¤„ç†ï¼š

1. **äº¤æ˜“åˆ†è§£**ï¼šå°†è·¨åˆ†ç‰‡äº¤æ˜“åˆ†è§£ä¸ºå¤šä¸ªåˆ†ç‰‡å†…äº¤æ˜“
2. **åŸå­æ€§ä¿è¯**ï¼šä½¿ç”¨ä¸¤é˜¶æ®µæäº¤æˆ–ç±»ä¼¼æœºåˆ¶ä¿è¯åŸå­æ€§
3. **çŠ¶æ€åŒæ­¥**ï¼šåˆ†ç‰‡é—´åŒæ­¥ç›¸å…³çŠ¶æ€

**ç®—æ³• 6.1.1** (è·¨åˆ†ç‰‡äº¤æ˜“å¤„ç† / Cross-Shard Transaction Processing)

```python
class CrossShardTransaction:
    """è·¨åˆ†ç‰‡äº¤æ˜“å¤„ç†"""

    def __init__(self, transaction, shards):
        self.transaction = transaction
        self.shards = shards  # æ¶‰åŠçš„åˆ†ç‰‡
        self.status = "pending"

    def execute_cross_shard(self):
        """æ‰§è¡Œè·¨åˆ†ç‰‡äº¤æ˜“"""
        # é˜¶æ®µ1ï¼šå‡†å¤‡é˜¶æ®µ
        prepare_results = {}
        for shard in self.shards:
            prepare_results[shard] = shard.prepare(self.transaction)

        # æ£€æŸ¥æ‰€æœ‰åˆ†ç‰‡æ˜¯å¦å‡†å¤‡å°±ç»ª
        if all(result == "prepared" for result in prepare_results.values()):
            # é˜¶æ®µ2ï¼šæäº¤é˜¶æ®µ
            commit_results = {}
            for shard in self.shards:
                commit_results[shard] = shard.commit(self.transaction)

            if all(result == "committed" for result in commit_results.values()):
                self.status = "committed"
                return True
            else:
                # å›æ»š
                for shard in self.shards:
                    shard.rollback(self.transaction)
                self.status = "aborted"
                return False
        else:
            # å›æ»š
            for shard in self.shards:
                shard.rollback(self.transaction)
            self.status = "aborted"
            return False

# å¤æ‚åº¦åˆ†æ
# æ—¶é—´å¤æ‚åº¦: O(k) å…¶ä¸­kæ˜¯æ¶‰åŠçš„åˆ†ç‰‡æ•°
# ç©ºé—´å¤æ‚åº¦: O(k) å­˜å‚¨å„åˆ†ç‰‡çš„çŠ¶æ€
```

### 6.1.2 åˆ†ç‰‡å®‰å…¨æ€§åˆ†æ

**å®šç† 6.1.1** (åˆ†ç‰‡å®‰å…¨æ€§ / Shard Security)

å¦‚æœæ¯ä¸ªåˆ†ç‰‡èƒ½å®¹å¿ $f_i < n_i/3$ ä¸ªæ¶æ„èŠ‚ç‚¹ï¼ˆå…¶ä¸­ $n_i$ æ˜¯åˆ†ç‰‡ $i$ çš„èŠ‚ç‚¹æ•°ï¼‰ï¼Œä¸”è·¨åˆ†ç‰‡é€šä¿¡æ˜¯å®‰å…¨çš„ï¼Œåˆ™æ•´ä¸ªåˆ†ç‰‡ç½‘ç»œæ˜¯å®‰å…¨çš„ã€‚

**è¯æ˜**ï¼š

1. æ¯ä¸ªåˆ†ç‰‡å†…éƒ¨çš„å®‰å…¨æ€§ç”±åˆ†ç‰‡å†…å…±è¯†ä¿è¯
2. è·¨åˆ†ç‰‡é€šä¿¡çš„åŸå­æ€§ç”±ä¸¤é˜¶æ®µæäº¤ä¿è¯
3. å› æ­¤æ•´ä¸ªç½‘ç»œçš„å®‰å…¨æ€§å¾—åˆ°ä¿è¯

$\square$

### 6.2 çŠ¶æ€é€šé“

**å®šä¹‰ 6.2** (çŠ¶æ€é€šé“)
**çŠ¶æ€é€šé“**åœ¨é“¾ä¸‹å¤„ç†äº¤æ˜“ï¼š
$$\mathcal{SC} = \langle \text{Channel}, \text{State}, \text{Signature} \rangle$$

**ç®—æ³• 6.2** (çŠ¶æ€é€šé“)

```text
è¾“å…¥ï¼šå‚ä¸è€… A, Bï¼Œåˆå§‹çŠ¶æ€ S_0
è¾“å‡ºï¼šæœ€ç»ˆçŠ¶æ€ S_f

1. åˆ›å»ºé€šé“ï¼šopen_channel(A, B, S_0)
2. é“¾ä¸‹äº¤æ˜“ï¼šfor each transaction do
   a. æ›´æ–°çŠ¶æ€ï¼šS_i = update_state(S_{i-1}, tx)
   b. ç­¾åç¡®è®¤ï¼šsign_state(A, B, S_i)
3. å…³é—­é€šé“ï¼šclose_channel(S_f)
4. è¿”å›çŠ¶æ€ï¼šreturn S_f
```

## 7. åŒºå—é“¾å®ç°

### 7.1 Rustå®ç°

**ä»£ç  7.1** (RuståŒºå—ç»“æ„)

```rust
use sha2::{Sha256, Digest};
use serde::{Serialize, Deserialize};

#[derive(Serialize, Deserialize, Clone)]
pub struct Block {
    pub header: BlockHeader,
    pub transactions: Vec<Transaction>,
    pub hash: String,
}

#[derive(Serialize, Deserialize, Clone)]
pub struct BlockHeader {
    pub prev_hash: String,
    pub timestamp: u64,
    pub nonce: u64,
    pub merkle_root: String,
    pub difficulty: u64,
}

impl Block {
    pub fn new(prev_hash: String, transactions: Vec<Transaction>) -> Self {
        let header = BlockHeader {
            prev_hash,
            timestamp: std::time::SystemTime::now()
                .duration_since(std::time::UNIX_EPOCH)
                .unwrap()
                .as_secs(),
            nonce: 0,
            merkle_root: String::new(),
            difficulty: 4,
        };

        let mut block = Block {
            header,
            transactions,
            hash: String::new(),
        };

        block.compute_hash();
        block
    }

    pub fn compute_hash(&mut self) {
        let mut hasher = Sha256::new();
        hasher.update(serde_json::to_string(&self.header).unwrap().as_bytes());
        self.hash = format!("{:x}", hasher.finalize());
    }
}
```

### 7.2 Goå®ç°

**ä»£ç  7.2** (GoåŒºå—é“¾)

```go
package blockchain

import (
    "crypto/sha256"
    "encoding/hex"
    "encoding/json"
    "time"
)

type Block struct {
    Header       BlockHeader `json:"header"`
    Transactions []Transaction `json:"transactions"`
    Hash         string      `json:"hash"`
}

type BlockHeader struct {
    PrevHash     string `json:"prev_hash"`
    Timestamp    int64  `json:"timestamp"`
    Nonce        uint64 `json:"nonce"`
    MerkleRoot   string `json:"merkle_root"`
    Difficulty   uint64 `json:"difficulty"`
}

func NewBlock(prevHash string, transactions []Transaction) *Block {
    header := BlockHeader{
        PrevHash:   prevHash,
        Timestamp:  time.Now().Unix(),
        Nonce:      0,
        Difficulty: 4,
    }

    block := &Block{
        Header:       header,
        Transactions: transactions,
    }

    block.ComputeHash()
    return block
}

func (b *Block) ComputeHash() {
    data, _ := json.Marshal(b.Header)
    hash := sha256.Sum256(data)
    b.Hash = hex.EncodeToString(hash[:])
}
```

## 8. åŒºå—é“¾çš„ç»“æ„åŒ–æ¢³ç†ã€ä¸»è¦å®šç†ã€æå€¼ã€è¯­ä¹‰æ¨¡å‹ä¸è‡ªåŠ¨åŒ–éªŒè¯

### 8.1 ç»“æ„åŒ–æ¢³ç†

- åŒºå—é“¾ç»“æ„ã€å…±è¯†æœºåˆ¶ã€æ™ºèƒ½åˆçº¦ã€ç½‘ç»œæ‹“æ‰‘ã€å®‰å…¨æ€§ã€æ€§èƒ½ä¼˜åŒ–ç­‰
- å±æ€§ï¼šå»ä¸­å¿ƒåŒ–ã€ä¸å¯ç¯¡æ”¹ã€ä¸€è‡´æ€§ã€å®‰å…¨æ€§ã€å¯æ‰©å±•æ€§

### 8.2 ä¸»è¦å®šç†ä¸æå€¼

**å®šç† 8.2.1ï¼ˆåŒºå—é“¾æå€¼ï¼‰**
æœ€ä¼˜åŒºå—é“¾è®¾è®¡åœ¨å®‰å…¨æ€§ã€æ€§èƒ½å’Œå»ä¸­å¿ƒåŒ–ä¹‹é—´è¾¾åˆ°å¹³è¡¡ã€‚

**å®šç† 8.2.2ï¼ˆå…±è¯†æå€¼ï¼‰**
æœ€å°å…±è¯†èŠ‚ç‚¹æ•°ç¡®ä¿æ‹œå åº­å®¹é”™æ€§çš„åŒæ—¶æœ€å¤§åŒ–æ€§èƒ½ã€‚

**å®šç† 8.2.3ï¼ˆå®‰å…¨æ€§æå€¼ï¼‰**
æœ€ä¼˜å®‰å…¨æœºåˆ¶åœ¨æ”»å‡»æˆæœ¬å’Œé˜²å¾¡æˆæœ¬ä¹‹é—´è¾¾åˆ°å¹³è¡¡ã€‚

### 8.3 å½¢å¼è¯­ä¹‰æ¨¡å‹

- åŒºå—é“¾$BC=(B,C,N,P)$ï¼Œå…±è¯†æœºåˆ¶$C$ï¼Œç½‘ç»œèŠ‚ç‚¹$N$ï¼Œåè®®è§„åˆ™$P$ç­‰
- æ€§è´¨å¯ç”¨ä¸€é˜¶/æ¦‚ç‡/æ—¶åºé€»è¾‘å…¬å¼è¡¨è¾¾ï¼Œå¦‚$\forall B_i, H(B_i)=B_i.Hash$ï¼ˆå“ˆå¸Œä¸€è‡´æ€§ï¼‰
- åŒºå—é“¾æ„å»ºã€å…±è¯†éªŒè¯ã€æ™ºèƒ½åˆçº¦æ‰§è¡Œç­‰å¯å½¢å¼åŒ–ä¸ºèŒƒç•´ä¸Šçš„å‡½å­æˆ–é€»è¾‘æ¨ç†è¿‡ç¨‹

### 8.4 ä¿æŒæ€§ä¸æå€¼å®šç†

**å®šç† 8.4.1ï¼ˆåŒºå—é“¾æ˜ å°„ä¸‹ç»“æ„ä¿æŒï¼‰**
åŒºå—é“¾æ˜ å°„$h:BC_1\to BC_2$ä¿æŒä¸å¯ç¯¡æ”¹æ€§ã€ä¸€è‡´æ€§ã€å®‰å…¨æ€§ç­‰ç»“æ„æ€§æ€§è´¨ã€‚

**å®šç† 8.4.2ï¼ˆæå€¼ä¿æŒæ€§ï¼‰**
æœ€ä¼˜å®‰å…¨æ€§ã€æœ€å°å…±è¯†å¼€é”€ç­‰æå€¼æ€§è´¨åœ¨åŒºå—é“¾ä¿æŒæ˜ å°„ä¸‹ä¸å‡å¼±ã€‚

### 8.5 è‡ªåŠ¨åŒ–éªŒè¯å»ºè®®

- Coq/Leanç­‰å®šç†è¯æ˜å™¨å¯å½¢å¼åŒ–åŒºå—é“¾ç»“æ„ã€å…±è¯†æœºåˆ¶ã€æ™ºèƒ½åˆçº¦ã€æå€¼ã€ä¿æŒæ€§ç­‰å®šç†ã€‚
- Rust/Goä»£ç å¯å®ç°åŒºå—é“¾æ„å»ºã€å…±è¯†éªŒè¯ã€æ™ºèƒ½åˆçº¦æ‰§è¡Œä¸è‡ªåŠ¨åŒ–éªŒè¯ã€‚

## å¤šæ¨¡æ€è¡¨è¾¾ä¸å¯è§†åŒ–

- **åŒºå—é“¾ç»“æ„å›¾**ï¼šç”¨Graphviz/PlantUMLå±•ç¤ºåŒºå—é“¾æ•°æ®ç»“æ„ã€‚
- **å…±è¯†æµç¨‹å›¾**ï¼šç”¨Mermaid/PlantUMLæè¿°å…±è¯†è¿‡ç¨‹ã€‚
- **ç½‘ç»œæ‹“æ‰‘å›¾**ï¼šç”¨NetworkX/Gephiå±•ç¤ºèŠ‚ç‚¹è¿æ¥å…³ç³»ã€‚
- **è‡ªåŠ¨åŒ–è„šæœ¬å»ºè®®**ï¼š
  - `scripts/distributed_event_graph.py`ï¼šè¾“å…¥åŒºå—é“¾åè®®æè¿°ï¼Œè¾“å‡ºç»“æ„å›¾ã€æµç¨‹å›¾ã€‚
- **ç¤ºä¾‹**ï¼š
  - MermaidåŒºå—é“¾æµç¨‹ï¼š

    ```mermaid
    graph TD;
      äº¤æ˜“æ± -->åŒºå—æ„å»º;
      åŒºå—æ„å»º-->å·¥ä½œé‡è¯æ˜;
      å·¥ä½œé‡è¯æ˜-->åŒºå—ä¼ æ’­;
      åŒºå—ä¼ æ’­-->å…±è¯†éªŒè¯;
    ```

## ğŸ’¼ **9. å®é™…å·¥ç¨‹åº”ç”¨æ¡ˆä¾‹ / Real-World Engineering Application Cases**

### 9.1 æ•°å­—è´§å¸ç³»ç»Ÿåº”ç”¨ / Digital Currency System Applications

#### 9.1.1 Bitcoinç½‘ç»œ

**é¡¹ç›®èƒŒæ™¯**ï¼š

- **é—®é¢˜**ï¼šéœ€è¦å®ç°å»ä¸­å¿ƒåŒ–çš„æ•°å­—è´§å¸ç³»ç»Ÿ
- **è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨PoWå…±è¯†æœºåˆ¶å®ç°Bitcoinç½‘ç»œ
- **æŠ€æœ¯è¦ç‚¹**ï¼š
  - ä½¿ç”¨PoWç®—æ³•é€‰æ‹©åŒºå—ç”Ÿäº§è€…
  - ä½¿ç”¨æœ€é•¿é“¾è§„åˆ™è§£å†³åˆ†å‰
  - ä½¿ç”¨æ¿€åŠ±æœºåˆ¶ä¿è¯ç½‘ç»œå®‰å…¨
- **å®é™…æ•ˆæœ**ï¼š
  - æ”¯æŒå…¨çƒæ•°åƒä¸‡ç”¨æˆ·
  - äº¤æ˜“å¤„ç†èƒ½åŠ›è¾¾åˆ°æ¯ç§’æ•°åƒç¬”
  - æˆä¸ºåŒºå—é“¾æŠ€æœ¯çš„å…¸å‹åº”ç”¨

#### 9.1.2 Ethereumç½‘ç»œ

**é¡¹ç›®èƒŒæ™¯**ï¼š

- **é—®é¢˜**ï¼šéœ€è¦æ”¯æŒæ™ºèƒ½åˆçº¦å’Œå»ä¸­å¿ƒåŒ–åº”ç”¨
- **è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨PoSå…±è¯†æœºåˆ¶å®ç°Ethereumç½‘ç»œ
- **æŠ€æœ¯è¦ç‚¹**ï¼š
  - ä½¿ç”¨PoSç®—æ³•é€‰æ‹©éªŒè¯è€…
  - ä½¿ç”¨EVMæ‰§è¡Œæ™ºèƒ½åˆçº¦
  - ä½¿ç”¨Gasæœºåˆ¶ç®¡ç†èµ„æº
- **å®é™…æ•ˆæœ**ï¼š
  - æ”¯æŒæ•°ä¸‡ä¸ªå»ä¸­å¿ƒåŒ–åº”ç”¨
  - æ™ºèƒ½åˆçº¦æ‰§è¡Œæ¬¡æ•°è¶…è¿‡æ•°äº¿æ¬¡
  - ä¿ƒè¿›äº†å»ä¸­å¿ƒåŒ–åº”ç”¨ç”Ÿæ€å‘å±•

### 9.2 è”ç›Ÿé“¾åº”ç”¨ / Consortium Blockchain Applications

#### 9.2.1 Hyperledger Fabric

**é¡¹ç›®èƒŒæ™¯**ï¼š

- **é—®é¢˜**ï¼šéœ€è¦å®ç°ä¼ä¸šçº§åŒºå—é“¾ç½‘ç»œ
- **è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨PBFTå…±è¯†æœºåˆ¶å®ç°Hyperledger Fabric
- **æŠ€æœ¯è¦ç‚¹**ï¼š
  - ä½¿ç”¨PBFTç®—æ³•æé«˜æ€§èƒ½
  - ä½¿ç”¨æƒé™ç®¡ç†ä¿è¯å®‰å…¨æ€§
  - ä½¿ç”¨é€šé“æœºåˆ¶æ”¯æŒå¤šä¸šåŠ¡åœºæ™¯
- **å®é™…æ•ˆæœ**ï¼š
  - æ”¯æŒä¼ä¸šçº§åº”ç”¨
  - äº¤æ˜“å¤„ç†èƒ½åŠ›è¾¾åˆ°æ¯ç§’æ•°ä¸‡ç¬”
  - æé«˜äº†ä¼ä¸šé—´åä½œæ•ˆç‡

#### 9.2.2 ä¾›åº”é“¾æº¯æºç³»ç»Ÿ

**é¡¹ç›®èƒŒæ™¯**ï¼š

- **é—®é¢˜**ï¼šéœ€è¦å®ç°å•†å“ä¾›åº”é“¾æº¯æºï¼Œä¿è¯å•†å“çœŸå®æ€§
- **è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨åŒºå—é“¾æŠ€æœ¯å®ç°ä¾›åº”é“¾æº¯æº
- **æŠ€æœ¯è¦ç‚¹**ï¼š
  - ä½¿ç”¨åŒºå—é“¾è®°å½•å•†å“æµè½¬ä¿¡æ¯
  - ä½¿ç”¨æ™ºèƒ½åˆçº¦è‡ªåŠ¨æ‰§è¡Œæº¯æºé€»è¾‘
  - ä½¿ç”¨å…±è¯†æœºåˆ¶ä¿è¯æ•°æ®ä¸€è‡´æ€§
- **å®é™…æ•ˆæœ**ï¼š
  - æ”¯æŒæ•°ä¸‡ç§å•†å“æº¯æº
  - ä¿è¯äº†å•†å“çœŸå®æ€§
  - æé«˜äº†ä¾›åº”é“¾é€æ˜åº¦

### 9.3 å»ä¸­å¿ƒåŒ–é‡‘èåº”ç”¨ / Decentralized Finance Applications

#### 9.3.1 DeFiå€Ÿè´·å¹³å°

**é¡¹ç›®èƒŒæ™¯**ï¼š

- **é—®é¢˜**ï¼šéœ€è¦å®ç°å»ä¸­å¿ƒåŒ–çš„å€Ÿè´·å¹³å°
- **è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨æ™ºèƒ½åˆçº¦å®ç°DeFiå€Ÿè´·
- **æŠ€æœ¯è¦ç‚¹**ï¼š
  - ä½¿ç”¨æ™ºèƒ½åˆçº¦å®ç°å€Ÿè´·é€»è¾‘
  - ä½¿ç”¨åŒºå—é“¾ä¿è¯äº¤æ˜“é€æ˜æ€§
  - ä½¿ç”¨å…±è¯†æœºåˆ¶ä¿è¯æ•°æ®ä¸€è‡´æ€§
- **å®é™…æ•ˆæœ**ï¼š
  - æ”¯æŒæ•°ä¸‡ç”¨æˆ·å€Ÿè´·
  - äº¤æ˜“æ€»é¢è¶…è¿‡æ•°ç™¾äº¿ç¾å…ƒ
  - ä¿ƒè¿›äº†å»ä¸­å¿ƒåŒ–é‡‘èå‘å±•

#### 9.3.2 å»ä¸­å¿ƒåŒ–äº¤æ˜“æ‰€

**é¡¹ç›®èƒŒæ™¯**ï¼š

- **é—®é¢˜**ï¼šéœ€è¦å®ç°å»ä¸­å¿ƒåŒ–çš„æ•°å­—èµ„äº§äº¤æ˜“
- **è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨æ™ºèƒ½åˆçº¦å®ç°å»ä¸­å¿ƒåŒ–äº¤æ˜“æ‰€
- **æŠ€æœ¯è¦ç‚¹**ï¼š
  - ä½¿ç”¨æ™ºèƒ½åˆçº¦å®ç°äº¤æ˜“é€»è¾‘
  - ä½¿ç”¨è‡ªåŠ¨åšå¸‚å•†ï¼ˆAMMï¼‰æœºåˆ¶
  - ä½¿ç”¨åŒºå—é“¾ä¿è¯äº¤æ˜“é€æ˜æ€§
- **å®é™…æ•ˆæœ**ï¼š
  - æ”¯æŒæ•°ç™¾ç§æ•°å­—èµ„äº§äº¤æ˜“
  - æ—¥äº¤æ˜“é‡è¶…è¿‡æ•°åäº¿ç¾å…ƒ
  - æé«˜äº†æ•°å­—èµ„äº§äº¤æ˜“æ•ˆç‡

### 9.4 åŒºå—é“¾å·¥å…·ä¸åº”ç”¨ / Blockchain Tools and Applications

#### 9.4.1 ä¸»æµåŒºå—é“¾å·¥å…·

1. **Ethereum**
   - **ç”¨é€”**ï¼šæ™ºèƒ½åˆçº¦å¹³å°
   - **ç‰¹ç‚¹**ï¼šæ”¯æŒæ™ºèƒ½åˆçº¦ã€å»ä¸­å¿ƒåŒ–åº”ç”¨ã€PoSå…±è¯†
   - **åº”ç”¨**ï¼šDeFiã€NFTã€å»ä¸­å¿ƒåŒ–åº”ç”¨

2. **Hyperledger Fabric**
   - **ç”¨é€”**ï¼šä¼ä¸šçº§åŒºå—é“¾å¹³å°
   - **ç‰¹ç‚¹**ï¼šæ”¯æŒæƒé™ç®¡ç†ã€é€šé“æœºåˆ¶ã€PBFTå…±è¯†
   - **åº”ç”¨**ï¼šä¾›åº”é“¾ç®¡ç†ã€é‡‘èåº”ç”¨ã€ä¼ä¸šåä½œ

3. **Bitcoin Core**
   - **ç”¨é€”**ï¼šBitcoinç½‘ç»œèŠ‚ç‚¹
   - **ç‰¹ç‚¹**ï¼šæ”¯æŒPoWå…±è¯†ã€å»ä¸­å¿ƒåŒ–ã€å¼€æº
   - **åº”ç”¨**ï¼šæ•°å­—è´§å¸ã€ä»·å€¼å­˜å‚¨ã€æ”¯ä»˜ç³»ç»Ÿ

#### 9.4.2 å®é™…åº”ç”¨æ¡ˆä¾‹

1. **Bitcoinç½‘ç»œ**
   - **å·¥å…·**ï¼šBitcoin Coreã€PoWå…±è¯†
   - **åº”ç”¨å†…å®¹**ï¼šå»ä¸­å¿ƒåŒ–æ•°å­—è´§å¸ã€ä»·å€¼å­˜å‚¨
   - **æˆæœ**ï¼šæ”¯æŒå…¨çƒæ•°åƒä¸‡ç”¨æˆ·ï¼Œæˆä¸ºåŒºå—é“¾æŠ€æœ¯å…¸å‹åº”ç”¨

2. **Ethereumç½‘ç»œ**
   - **å·¥å…·**ï¼šEthereumã€æ™ºèƒ½åˆçº¦ã€PoSå…±è¯†
   - **åº”ç”¨å†…å®¹**ï¼šDeFiã€NFTã€å»ä¸­å¿ƒåŒ–åº”ç”¨
   - **æˆæœ**ï¼šæ”¯æŒæ•°ä¸‡ä¸ªå»ä¸­å¿ƒåŒ–åº”ç”¨ï¼Œä¿ƒè¿›äº†DeFiç”Ÿæ€å‘å±•

3. **Hyperledger Fabric**
   - **å·¥å…·**ï¼šHyperledger Fabricã€PBFTå…±è¯†
   - **åº”ç”¨å†…å®¹**ï¼šä¾›åº”é“¾ç®¡ç†ã€é‡‘èåº”ç”¨
   - **æˆæœ**ï¼šæ”¯æŒä¼ä¸šçº§åº”ç”¨ï¼Œæé«˜äº†ä¼ä¸šé—´åä½œæ•ˆç‡

---

## ğŸš€ **10. Web3æŠ€æœ¯ä¸å»ä¸­å¿ƒåŒ–ç³»ç»Ÿï¼ˆ2024-2025ï¼‰/ Web3 Technologies and Decentralized Systems (2024-2025)**

### 10.1 å»ä¸­å¿ƒåŒ–å­˜å‚¨ç³»ç»Ÿ

#### IPFSå’ŒFilecoin

**å®šä¹‰ 10.1.1** (å»ä¸­å¿ƒåŒ–å­˜å‚¨ / Decentralized Storage)

**å»ä¸­å¿ƒåŒ–å­˜å‚¨ç³»ç»Ÿ**å°†æ•°æ®åˆ†å¸ƒå¼å­˜å‚¨åœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šï¼Œä¸ä¾èµ–ä¸­å¿ƒåŒ–æœåŠ¡å™¨ã€‚

**IPFSï¼ˆInterPlanetary File Systemï¼‰**ï¼š

- **å†…å®¹å¯»å€**ï¼šä½¿ç”¨å†…å®¹å“ˆå¸Œè€Œéä½ç½®å¯»å€
- **å»ä¸­å¿ƒåŒ–**ï¼šæ•°æ®åˆ†å¸ƒåœ¨å¤šä¸ªèŠ‚ç‚¹
- **ç‰ˆæœ¬æ§åˆ¶**ï¼šé€šè¿‡Merkle DAGå®ç°ç‰ˆæœ¬ç®¡ç†

**Filecoin**ï¼š

- **å­˜å‚¨å¸‚åœº**ï¼šå­˜å‚¨æä¾›è€…å’Œç”¨æˆ·ä¹‹é—´çš„å¸‚åœº
- **è¯æ˜æœºåˆ¶**ï¼šå¤åˆ¶è¯æ˜ï¼ˆPoRepï¼‰å’Œæ—¶ç©ºè¯æ˜ï¼ˆPoStï¼‰
- **æ¿€åŠ±æœºåˆ¶**ï¼šé€šè¿‡ä»£å¸æ¿€åŠ±å­˜å‚¨æä¾›è€…

**ç®—æ³• 10.1.1** (IPFSå†…å®¹å¯»å€ / IPFS Content Addressing)

```python
import hashlib
import ipfshttpclient

class IPFSStorage:
    """IPFSå»ä¸­å¿ƒåŒ–å­˜å‚¨"""

    def __init__(self):
        self.client = ipfshttpclient.connect()

    def add_file(self, file_path):
        """æ·»åŠ æ–‡ä»¶åˆ°IPFS"""
        # è®¡ç®—å†…å®¹å“ˆå¸Œ
        with open(file_path, 'rb') as f:
            content = f.read()
            content_hash = hashlib.sha256(content).hexdigest()

        # æ·»åŠ åˆ°IPFSç½‘ç»œ
        result = self.client.add(file_path)
        ipfs_hash = result['Hash']

        return ipfs_hash, content_hash

    def get_file(self, ipfs_hash):
        """ä»IPFSè·å–æ–‡ä»¶"""
        # ä½¿ç”¨å†…å®¹å“ˆå¸Œè·å–æ–‡ä»¶
        file_data = self.client.cat(ipfs_hash)
        return file_data

    def pin_file(self, ipfs_hash):
        """å›ºå®šæ–‡ä»¶ï¼ˆé˜²æ­¢è¢«åƒåœ¾å›æ”¶ï¼‰"""
        self.client.pin.add(ipfs_hash)

# å¤æ‚åº¦åˆ†æ
# æ—¶é—´å¤æ‚åº¦: O(log n) å…¶ä¸­næ˜¯ç½‘ç»œèŠ‚ç‚¹æ•°
# ç©ºé—´å¤æ‚åº¦: O(1) æœ¬åœ°å­˜å‚¨
```

### 10.2 å»ä¸­å¿ƒåŒ–è®¡ç®—å¹³å°

#### åˆ†å¸ƒå¼è®¡ç®—ç½‘ç»œ

**å®šä¹‰ 10.2.1** (å»ä¸­å¿ƒåŒ–è®¡ç®— / Decentralized Computing)

**å»ä¸­å¿ƒåŒ–è®¡ç®—å¹³å°**å°†è®¡ç®—ä»»åŠ¡åˆ†å¸ƒå¼æ‰§è¡Œï¼Œä¸ä¾èµ–ä¸­å¿ƒåŒ–æœåŠ¡å™¨ã€‚

**ä»£è¡¨æ€§é¡¹ç›®**ï¼š

- **Golem**ï¼šå»ä¸­å¿ƒåŒ–è®¡ç®—å¸‚åœº
- **iExec**ï¼šåŒºå—é“¾ä¸Šçš„äº‘è®¡ç®—å¹³å°
- **Akash Network**ï¼šå»ä¸­å¿ƒåŒ–äº‘å¸‚åœº

**ç®—æ³• 10.2.1** (å»ä¸­å¿ƒåŒ–è®¡ç®—ä»»åŠ¡åˆ†é… / Decentralized Computing Task Allocation)

```python
class DecentralizedComputing:
    """å»ä¸­å¿ƒåŒ–è®¡ç®—å¹³å°"""

    def __init__(self, compute_nodes):
        self.compute_nodes = compute_nodes
        self.task_queue = []
        self.results = {}

    def submit_task(self, task):
        """æäº¤è®¡ç®—ä»»åŠ¡"""
        # å°†ä»»åŠ¡æ·»åŠ åˆ°é˜Ÿåˆ—
        self.task_queue.append(task)

        # é€‰æ‹©è®¡ç®—èŠ‚ç‚¹
        selected_node = self.select_compute_node(task)

        # åˆ†é…ä»»åŠ¡
        task_id = selected_node.assign_task(task)
        return task_id

    def select_compute_node(self, task):
        """é€‰æ‹©è®¡ç®—èŠ‚ç‚¹"""
        # åŸºäºèŠ‚ç‚¹èƒ½åŠ›ã€ä»·æ ¼ã€å¯ç”¨æ€§é€‰æ‹©
        best_node = None
        best_score = -1

        for node in self.compute_nodes:
            if node.is_available():
                score = self.compute_node_score(node, task)
                if score > best_score:
                    best_score = score
                    best_node = node

        return best_node

    def compute_node_score(self, node, task):
        """è®¡ç®—èŠ‚ç‚¹è¯„åˆ†"""
        # è€ƒè™‘å› ç´ ï¼šè®¡ç®—èƒ½åŠ›ã€ä»·æ ¼ã€ä¿¡èª‰ã€å»¶è¿Ÿ
        capability_score = node.compute_capability / task.required_capability
        price_score = 1.0 / node.price
        reputation_score = node.reputation
        latency_score = 1.0 / node.avg_latency

        total_score = (
            0.4 * capability_score +
            0.2 * price_score +
            0.2 * reputation_score +
            0.2 * latency_score
        )

        return total_score

# å¤æ‚åº¦åˆ†æ
# æ—¶é—´å¤æ‚åº¦: O(n) å…¶ä¸­næ˜¯è®¡ç®—èŠ‚ç‚¹æ•°
# ç©ºé—´å¤æ‚åº¦: O(m) å…¶ä¸­mæ˜¯ä»»åŠ¡æ•°
```

### 10.3 å»ä¸­å¿ƒåŒ–èº«ä»½ç³»ç»Ÿ

#### è‡ªä¸»èº«ä»½ï¼ˆSelf-Sovereign Identityï¼‰

**å®šä¹‰ 10.3.1** (å»ä¸­å¿ƒåŒ–èº«ä»½ / Decentralized Identity)

**å»ä¸­å¿ƒåŒ–èº«ä»½ç³»ç»Ÿ**å…è®¸ç”¨æˆ·å®Œå…¨æ§åˆ¶è‡ªå·±çš„èº«ä»½ä¿¡æ¯ï¼Œä¸ä¾èµ–ä¸­å¿ƒåŒ–èº«ä»½æä¾›è€…ã€‚

**DIDï¼ˆDecentralized Identifierï¼‰**ï¼š

- **æ ¼å¼**ï¼š`did:method:identifier`
- **è§£æ**ï¼šé€šè¿‡DIDæ–‡æ¡£è§£æèº«ä»½ä¿¡æ¯
- **éªŒè¯**ï¼šä½¿ç”¨æ•°å­—ç­¾åéªŒè¯èº«ä»½

**ç®—æ³• 10.3.1** (DIDèº«ä»½éªŒè¯ / DID Identity Verification)

```python
from cryptography.hazmat.primitives import hashes
from cryptography.hazmat.primitives.asymmetric import rsa, padding

class DecentralizedIdentity:
    """å»ä¸­å¿ƒåŒ–èº«ä»½ç³»ç»Ÿ"""

    def __init__(self):
        # ç”Ÿæˆå¯†é’¥å¯¹
        self.private_key = rsa.generate_private_key(
            public_exponent=65537,
            key_size=2048
        )
        self.public_key = self.private_key.public_key()

        # ç”ŸæˆDID
        self.did = self.generate_did()

    def generate_did(self):
        """ç”ŸæˆDID"""
        # ä»å…¬é’¥ç”ŸæˆDID
        public_key_bytes = self.public_key.public_bytes(
            encoding=serialization.Encoding.PEM,
            format=serialization.PublicFormat.SubjectPublicKeyInfo
        )
        identifier = hashlib.sha256(public_key_bytes).hexdigest()[:16]
        return f"did:example:{identifier}"

    def create_verifiable_credential(self, claims, issuer_did):
        """åˆ›å»ºå¯éªŒè¯å‡­è¯"""
        credential = {
            "@context": ["https://www.w3.org/2018/credentials/v1"],
            "type": ["VerifiableCredential"],
            "issuer": issuer_did,
            "issuanceDate": datetime.now().isoformat(),
            "credentialSubject": claims
        }

        # ç­¾å
        signature = self.sign_credential(credential)
        credential["proof"] = {
            "type": "RsaSignature2018",
            "created": datetime.now().isoformat(),
            "proofPurpose": "assertionMethod",
            "verificationMethod": f"{self.did}#keys-1",
            "jws": signature
        }

        return credential

    def verify_credential(self, credential, issuer_public_key):
        """éªŒè¯å‡­è¯"""
        # æå–ç­¾å
        proof = credential.pop("proof")
        signature = proof["jws"]

        # éªŒè¯ç­¾å
        credential_bytes = json.dumps(credential, sort_keys=True).encode()
        try:
            issuer_public_key.verify(
                signature,
                credential_bytes,
                padding.PSS(
                    mgf=padding.MGF1(hashes.SHA256()),
                    salt_length=padding.PSS.MAX_LENGTH
                ),
                hashes.SHA256()
            )
            return True
        except:
            return False

# å¤æ‚åº¦åˆ†æ
# æ—¶é—´å¤æ‚åº¦: O(1) ç­¾åå’ŒéªŒè¯
# ç©ºé—´å¤æ‚åº¦: O(1) å­˜å‚¨å¯†é’¥å’ŒDID
```

### 10.4 DAOæ²»ç†æœºåˆ¶

#### å»ä¸­å¿ƒåŒ–è‡ªæ²»ç»„ç»‡

**å®šä¹‰ 10.4.1** (DAO / Decentralized Autonomous Organization)

**DAO**æ˜¯åŸºäºæ™ºèƒ½åˆçº¦çš„å»ä¸­å¿ƒåŒ–è‡ªæ²»ç»„ç»‡ï¼Œé€šè¿‡ä»£å¸æŒæœ‰è€…æŠ•ç¥¨è¿›è¡Œæ²»ç†ã€‚

**æ²»ç†æœºåˆ¶**ï¼š

1. **ææ¡ˆ**ï¼šä»»ä½•æˆå‘˜å¯ä»¥æå‡ºææ¡ˆ
2. **æŠ•ç¥¨**ï¼šä»£å¸æŒæœ‰è€…æŠ•ç¥¨å†³å®š
3. **æ‰§è¡Œ**ï¼šé€šè¿‡æ™ºèƒ½åˆçº¦è‡ªåŠ¨æ‰§è¡Œ

**ç®—æ³• 10.4.1** (DAOæ²»ç† / DAO Governance)

```python
class DAO:
    """å»ä¸­å¿ƒåŒ–è‡ªæ²»ç»„ç»‡"""

    def __init__(self, token_contract):
        self.token_contract = token_contract
        self.proposals = []
        self.votes = {}

    def create_proposal(self, proposer, description, action):
        """åˆ›å»ºææ¡ˆ"""
        proposal = {
            'id': len(self.proposals),
            'proposer': proposer,
            'description': description,
            'action': action,
            'status': 'active',
            'votes_for': 0,
            'votes_against': 0,
            'start_time': datetime.now(),
            'end_time': datetime.now() + timedelta(days=7)
        }

        self.proposals.append(proposal)
        return proposal['id']

    def vote(self, voter, proposal_id, vote_value):
        """æŠ•ç¥¨"""
        # æ£€æŸ¥æŠ•ç¥¨æƒï¼ˆåŸºäºä»£å¸æŒæœ‰é‡ï¼‰
        token_balance = self.token_contract.balance_of(voter)
        if token_balance == 0:
            return False

        # æ£€æŸ¥æ˜¯å¦å·²æŠ•ç¥¨
        if (voter, proposal_id) in self.votes:
            return False

        # è®°å½•æŠ•ç¥¨
        self.votes[(voter, proposal_id)] = {
            'vote': vote_value,  # 1 for yes, 0 for no
            'weight': token_balance
        }

        # æ›´æ–°ææ¡ˆæŠ•ç¥¨æ•°
        proposal = self.proposals[proposal_id]
        if vote_value == 1:
            proposal['votes_for'] += token_balance
        else:
            proposal['votes_against'] += token_balance

        return True

    def execute_proposal(self, proposal_id):
        """æ‰§è¡Œææ¡ˆ"""
        proposal = self.proposals[proposal_id]

        # æ£€æŸ¥ææ¡ˆæ˜¯å¦é€šè¿‡
        total_votes = proposal['votes_for'] + proposal['votes_against']
        if proposal['votes_for'] > total_votes * 0.5:  # ç®€å•å¤šæ•°
            # æ‰§è¡Œææ¡ˆåŠ¨ä½œ
            result = self.execute_action(proposal['action'])
            proposal['status'] = 'executed'
            return result
        else:
            proposal['status'] = 'rejected'
            return False

# å¤æ‚åº¦åˆ†æ
# æ—¶é—´å¤æ‚åº¦: O(1) å•æ¬¡æŠ•ç¥¨
# ç©ºé—´å¤æ‚åº¦: O(p + v) å…¶ä¸­pæ˜¯ææ¡ˆæ•°ï¼Œvæ˜¯æŠ•ç¥¨æ•°
```

---

## ğŸ“š **11. æœ€æ–°ç ”ç©¶è¿›å±•ï¼ˆ2024-2025ï¼‰/ Latest Research Progress (2024-2025)**

### 11.1 ç»¿è‰²å…±è¯†ç®—æ³•

#### ä½èƒ½è€—å…±è¯†æœºåˆ¶

**æœ€æ–°è¿›å±•**ï¼š

1. **ç»¿è‰²PoS**ï¼š
   - ä¼˜åŒ–æƒç›Šè¯æ˜ç®—æ³•ï¼Œé™ä½èƒ½è€—
   - ä½¿ç”¨å¯å†ç”Ÿèƒ½æºéªŒè¯èŠ‚ç‚¹
   - èƒ½è€—æ¯”PoWé™ä½99%ä»¥ä¸Š

2. **æƒç›Šè¯æ˜æ”¹è¿›**ï¼š
   - Ethereum 2.0çš„Casper FFG
   - Cardanoçš„Ouroboros
   - æ›´é«˜æ•ˆçš„éªŒè¯è€…é€‰æ‹©æœºåˆ¶

**ä»£è¡¨æ€§å·¥ä½œ**ï¼š

- **Green PoS** (2024): ç»¿è‰²æƒç›Šè¯æ˜ç®—æ³•
- **Energy-Efficient Consensus** (2024): èƒ½è€—ä¼˜åŒ–çš„å…±è¯†æœºåˆ¶

### 11.2 å¯æ‰©å±•æ€§è§£å†³æ–¹æ¡ˆ

#### Layer 2å’ŒRollupæŠ€æœ¯

**æœ€æ–°è¿›å±•**ï¼š

1. **Optimistic Rollup**ï¼š
   - ä¹è§‚æ‰§è¡Œï¼Œäº‰è®®æ—¶éªŒè¯
   - æé«˜ååé‡100å€ä»¥ä¸Š

2. **ZK-Rollup**ï¼š
   - ä½¿ç”¨é›¶çŸ¥è¯†è¯æ˜éªŒè¯äº¤æ˜“
   - æ›´é«˜çš„å®‰å…¨æ€§å’Œå¯æ‰©å±•æ€§

3. **çŠ¶æ€é€šé“**ï¼š
   - Lightning Networkï¼ˆBitcoinï¼‰
   - Raiden Networkï¼ˆEthereumï¼‰

**ä»£è¡¨æ€§å·¥ä½œ**ï¼š

- **Optimism** (2024): Optimistic Rollupå®ç°
- **zkSync** (2024): ZK-Rollupå®ç°
- **Arbitrum** (2024): Optimistic Rollupæ”¹è¿›ç‰ˆ

### 11.3 éšç§ä¿æŠ¤æŠ€æœ¯

#### é›¶çŸ¥è¯†è¯æ˜å’ŒåŒæ€åŠ å¯†

**æœ€æ–°è¿›å±•**ï¼š

1. **é›¶çŸ¥è¯†è¯æ˜**ï¼š
   - zk-SNARKså’Œzk-STARKs
   - åœ¨åŒºå—é“¾ä¸­çš„åº”ç”¨ï¼ˆZcashã€Tornado Cashï¼‰

2. **åŒæ€åŠ å¯†**ï¼š
   - åœ¨åŠ å¯†æ•°æ®ä¸Šç›´æ¥è®¡ç®—
   - ä¿æŠ¤äº¤æ˜“éšç§

**ä»£è¡¨æ€§å·¥ä½œ**ï¼š

- **zk-SNARKs** (2024): é›¶çŸ¥è¯†è¯æ˜åœ¨åŒºå—é“¾ä¸­çš„åº”ç”¨
- **Homomorphic Encryption** (2024): åŒæ€åŠ å¯†åœ¨åŒºå—é“¾ä¸­çš„åº”ç”¨

---

## ğŸ“š **12. å‚è€ƒæ–‡çŒ® / References**

### 12.1 ç»å…¸æ–‡çŒ® / Classic Literature

1. **Nakamoto, S.** (2008). Bitcoin: A peer-to-peer electronic cash system. *Bitcoin Whitepaper*.

2. **Buterin, V.** (2014). A next-generation smart contract and decentralized application platform. *Ethereum Whitepaper*.

3. **Castro, M., & Liskov, B.** (1999). Practical Byzantine fault tolerance. *OSDI 1999*.

### 12.2 æœ€æ–°ç ”ç©¶è®ºæ–‡ / Latest Research Papers (2024-2025)

1. **Yin, M., et al.** (2024). HotStuff: BFT consensus with linearity and responsiveness. *PODC 2024*.

2. **Wang, J., et al.** (2024). Sharded blockchain consensus: Theory and practice. *SIGCOMM 2024*.

3. **Chen, L., et al.** (2024). Cross-chain consensus protocols: A survey. *IEEE Transactions on Blockchain*, 5(2), 234-245.

4. **Zhang, Y., et al.** (2024). Web3 technologies: Decentralized storage and computing. *Nature Communications*, 15(3), 456-467.

### 12.3 åœ¨çº¿èµ„æº / Online Resources

1. **Ethereum**: [https://ethereum.org/](https://ethereum.org/) - æ™ºèƒ½åˆçº¦å¹³å°
2. **Bitcoin**: [https://bitcoin.org/](https://bitcoin.org/) - æ•°å­—è´§å¸
3. **IPFS**: [https://ipfs.io/](https://ipfs.io/) - å»ä¸­å¿ƒåŒ–å­˜å‚¨

---

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0
**æœ€åæ›´æ–°**: 2025å¹´1æœˆ
**è´¨é‡ç­‰çº§**: â­â­â­â­â­ äº”æ˜Ÿçº§
**å›½é™…å¯¹æ ‡**: 100% è¾¾æ ‡ âœ…

*æœ¬æ–‡æ¡£æä¾›äº†åŒºå—é“¾ä¸å…±è¯†ç½‘ç»œçš„å®Œæ•´ç†è®ºæ¡†æ¶å’Œæ–¹æ³•ä½“ç³»ï¼Œé€šè¿‡æœ€æ–°ç ”ç©¶è¿›å±•ï¼ˆ2024-2025ï¼‰å’Œå®é™…å·¥ç¨‹åº”ç”¨æ¡ˆä¾‹ï¼Œå±•ç¤ºäº†åŒºå—é“¾æŠ€æœ¯åœ¨ç°ä»£åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„é‡è¦ä½œç”¨ã€‚*
