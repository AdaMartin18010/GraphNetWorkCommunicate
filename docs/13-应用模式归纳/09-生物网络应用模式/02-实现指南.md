# ç”Ÿç‰©ç½‘ç»œåº”ç”¨æ¨¡å¼å®ç°æŒ‡å— / Biological Network Application Patterns Implementation Guide

## ğŸ“š **æ¦‚è¿° / Overview**

**æ–‡æ¡£ç›®çš„**: æä¾›ç”Ÿç‰©ç½‘ç»œé¢†åŸŸåº”ç”¨æ¨¡å¼çš„è¯¦ç»†å®ç°æŒ‡å—ï¼ŒåŒ…æ‹¬å·¥å…·é…ç½®ã€ä»£ç ç¤ºä¾‹ã€æœ€ä½³å®è·µã€‚

**é€‚ç”¨å¯¹è±¡**: ç”Ÿç‰©ä¿¡æ¯å­¦å®¶ã€ç½‘ç»œç”Ÿç‰©å­¦å®¶ã€ç ”ç©¶äººå‘˜

---

## ğŸ¯ **ä¸€ã€ç¯å¢ƒå‡†å¤‡ / Part 1: Environment Setup**

### 1.1 åŠ¨æ€å›¾è®ºå·¥å…·å®‰è£…

#### NetworkX

**å®‰è£…æ­¥éª¤**:

```bash
pip install networkx
pip install matplotlib
pip install numpy
```

### 1.2 æ‹“æ‰‘åˆ†æå·¥å…·å®‰è£…

#### GUDHI + Ripser

**å®‰è£…æ­¥éª¤**:

```bash
pip install gudhi
pip install ripser
pip install giotto-tda
```

#### KeplerMapper

**å®‰è£…æ­¥éª¤**:

```bash
pip install kmapper
pip install scikit-learn
```

---

## ğŸ”§ **äºŒã€åŸºå› è°ƒæ§ç½‘ç»œåˆ†æå®ç° / Part 2: Gene Regulatory Network Analysis Implementation**

### 2.1 ç½‘ç»œæ„å»º

**NetworkXå®ç°**:

```python
import networkx as nx
import numpy as np

class GeneRegulatoryNetwork:
    def __init__(self):
        self.graph = nx.DiGraph()
        self.gene_attributes = {}

    def add_gene(self, gene_id, gene_name, gene_type):
        """
        æ·»åŠ åŸºå› èŠ‚ç‚¹
        """
        self.graph.add_node(
            gene_id,
            name=gene_name,
            type=gene_type
        )
        self.gene_attributes[gene_id] = {
            'name': gene_name,
            'type': gene_type
        }

    def add_regulation(self, regulator, target, regulation_type, strength):
        """
        æ·»åŠ è°ƒæ§å…³ç³»
        """
        self.graph.add_edge(
            regulator,
            target,
            type=regulation_type,
            strength=strength
        )

    def identify_key_regulators(self):
        """
        è¯†åˆ«å…³é”®è°ƒæ§åŸºå› 
        """
        betweenness = nx.betweenness_centrality(self.graph)
        out_degree = dict(self.graph.out_degree())

        key_regulators = []
        for gene in self.graph.nodes():
            score = (
                betweenness[gene] * 0.5 +
                (out_degree[gene] / max(out_degree.values())) * 0.5
            )
            key_regulators.append({
                'gene': gene,
                'score': score,
                'betweenness': betweenness[gene],
                'out_degree': out_degree[gene]
            })

        key_regulators.sort(key=lambda x: x['score'], reverse=True)
        return key_regulators[:10]
```

### 2.2 ç¤¾åŒºæ£€æµ‹

**Louvainç®—æ³•å®ç°**:

```python
from networkx.algorithms import community

class NetworkModuleAnalyzer:
    def __init__(self, grn):
        self.grn = grn

    def detect_modules(self):
        """
        æ£€æµ‹è°ƒæ§æ¨¡å—
        """
        undirected_graph = self.grn.graph.to_undirected()
        communities = community.louvain_communities(undirected_graph)

        modules = []
        for i, community in enumerate(communities):
            module_genes = list(community)
            module_graph = self.grn.graph.subgraph(module_genes)

            module_features = {
                'module_id': i,
                'genes': module_genes,
                'size': len(module_genes),
                'density': nx.density(module_graph),
                'avg_clustering': nx.average_clustering(module_graph.to_undirected())
            }

            modules.append(module_features)

        return modules
```

---

## ğŸ”¬ **ä¸‰ã€æ‹“æ‰‘ç‰¹å¾åˆ†æå®ç° / Part 3: Topological Feature Analysis Implementation**

### 3.1 æŒä¹…åŒè°ƒåˆ†æ

**Ripserå®ç°**:

```python
from ripser import ripser
import numpy as np

class TopologicalNetworkAnalyzer:
    def __init__(self, grn):
        self.grn = grn

    def extract_topological_features(self):
        """
        æå–æ‹“æ‰‘ç‰¹å¾
        """
        embeddings = self._compute_node_embeddings()

        result = ripser(embeddings, maxdim=2)

        features = {
            'betti_0': len([x for x in result['dgms'][0] if x[1] == np.inf]),
            'betti_1': len([x for x in result['dgms'][1] if x[1] != np.inf]),
            'persistence_diagrams': result['dgms']
        }

        return features

    def _compute_node_embeddings(self):
        """
        è®¡ç®—èŠ‚ç‚¹åµŒå…¥
        """
        laplacian = nx.normalized_laplacian_matrix(self.grn.graph.to_undirected())
        eigenvalues, eigenvectors = np.linalg.eigh(laplacian.toarray())

        k = min(10, len(eigenvalues))
        embeddings = eigenvectors[:, :k]

        return embeddings
```

### 3.2 Mapperç®—æ³•åº”ç”¨

**KeplerMapperå®ç°**:

```python
import kmapper as km
from sklearn.manifold import TSNE
from sklearn import cluster

class GeneNetworkMapper:
    def __init__(self, grn):
        self.grn = grn

    def mapper_analysis(self):
        """
        ä½¿ç”¨Mapperç®—æ³•åˆ†æç½‘ç»œç»“æ„
        """
        node_features = []
        for node in self.grn.graph.nodes():
            features = [
                self.grn.graph.degree(node),
                nx.clustering(self.grn.graph.to_undirected(), node),
                nx.betweenness_centrality(self.grn.graph)[node]
            ]
            node_features.append(features)

        node_features = np.array(node_features)

        mapper = km.KeplerMapper(verbose=1)

        projected = mapper.fit_transform(
            node_features,
            projection=TSNE(n_components=2, random_state=42)
        )

        cover = km.Cover(n_cubes=10, perc_overlap=0.2)
        graph = mapper.map(
            projected,
            node_features,
            clusterer=cluster.DBSCAN(eps=0.5, min_samples=3),
            cover=cover
        )

        mapper.visualize(
            graph,
            path_html="gene_network_mapper.html",
            title="Gene Regulatory Network Structure"
        )

        return graph, mapper
```

---

## ğŸ“‹ **å››ã€æœ€ä½³å®è·µ / Part 4: Best Practices**

### 4.1 ç½‘ç»œæ„å»ºå®è·µ

1. **æ•°æ®è´¨é‡**: ç¡®ä¿è°ƒæ§å…³ç³»æ•°æ®å‡†ç¡®
2. **ç½‘ç»œè§„æ¨¡**: æ ¹æ®æ•°æ®è§„æ¨¡é€‰æ‹©åˆé€‚çš„ç®—æ³•
3. **ç‰¹å¾é€‰æ‹©**: é€‰æ‹©æœ‰æ„ä¹‰çš„ç½‘ç»œç‰¹å¾

### 4.2 åˆ†æå®è·µ

1. **å¤šå±‚æ¬¡åˆ†æ**: ä»èŠ‚ç‚¹åˆ°æ¨¡å—åˆ°æ•´ä½“ç½‘ç»œ
2. **ç»Ÿè®¡éªŒè¯**: ä½¿ç”¨ç»Ÿè®¡æ–¹æ³•éªŒè¯ç»“æœ
3. **ç”Ÿç‰©å­¦è§£é‡Š**: ç»“åˆç”Ÿç‰©å­¦çŸ¥è¯†è§£é‡Šç»“æœ

---

## ğŸ“š **äº”ã€å‚è€ƒæ–‡æ¡£ / Part 5: Reference Documents**

### 5.1 ç›¸å…³æ–‡æ¡£

- [ç”Ÿç‰©ç½‘ç»œåº”ç”¨æ¨¡å¼æ¸…å•](./ç”Ÿç‰©ç½‘ç»œåº”ç”¨æ¨¡å¼æ¸…å•.md)
- [è¯¦ç»†æ¡ˆä¾‹ï¼šåŸºå› è°ƒæ§ç½‘ç»œåˆ†æ](./01-è¯¦ç»†æ¡ˆä¾‹-åŸºå› è°ƒæ§ç½‘ç»œåˆ†æ.md)

### 5.2 å·¥å…·æ–‡æ¡£

- [NetworkXæ–‡æ¡£](https://networkx.org/documentation/)
- [GUDHIæ–‡æ¡£](https://gudhi.inria.fr/documentation/)
- [KeplerMapperæ–‡æ¡£](https://github.com/MLWave/kepler-mapper)

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**åˆ›å»ºæ—¶é—´**: 2025å¹´1æœˆ
**æœ€åæ›´æ–°**: 2025å¹´1æœˆ
**çŠ¶æ€**: âœ… å®Œæˆ
**ç»´æŠ¤è€…**: GraphNetWorkCommunicateé¡¹ç›®ç»„
