# 分布式系统应用模式清单 / Distributed Systems Application Patterns

## 📚 概述

聚焦共识、复制一致性、分区容错、故障恢复，提供建模选择、决策树、案例与工具栈。

## 🎯 核心问题与建模选择

- 协议安全性（不变式/无双主）：Petri网 + 可达/活性/安全性。
- 拓扑演化（副本、路由）：动态图（副本图/流量图）+ 增量路径/社区/中心性。
- 韧性与故障域：拓扑/持久同调检测割点、循环与稳健性。
- 性能/背压：Petri网状态方程 + 图流量 + 谱漂移监测。

## 🔀 决策树（简版）

1) 需要形式化证明安全/活性？→ Petri网或TLA+。
2) 大规模拓扑、实时监测？→ 动态图 + 流处理。
3) 关注韧性/连通性？→ 拓扑/同调检测割点与循环；或最小割。
4) 关注延迟/背压？→ Petri网标识负载 + 图最短路/流量瓶颈。

## 🧩 典型案例

- Raft / Paxos：Petri网验证选主/提交；动态图追踪副本拓扑。
- 两阶段/三阶段提交：可达性/超时路径分析；等待图检测阻塞。
- 反熵/修复：动态图传播路径；拓扑韧性评估。
- 服务网格 / 微服务：调用图演化；持久同调检测循环依赖。

## 🛠 工具栈

- Petri网/形式化：CPN Tools, TLA+, Spin (Promela)。
- 动态图：Flink/Kafka Streams + NetworkX/igraph；Neo4j/JanusGraph。
- 拓扑：GUDHI/Ripser；持久同调评估韧性；Mapper抽象拓扑形状。

## 📦 产出物

- 决策树：协议/监测/韧性建模选择。
- 校验报告：安全性/活性/有界性；拓扑连通/割点。
- 流式监控：副本拓扑、流量瓶颈、谱漂移。
- 示例模型：TLA+/Petri网/Promela 片段与验证脚本。

## ✅ 后续补充

- 完整决策树（Mermaid）与Raft/2PC简化示例。
- 流式副本拓扑监测示例（Flink + Neo4j）。
