# ç½‘ç»œå®‰å…¨åº”ç”¨æ¨¡å¼å·¥å…·é›†æˆæŒ‡å— / Network Security Tools Integration Guide

## ğŸ“š **æ¦‚è¿° / Overview**

**æ–‡æ¡£ç›®çš„**: æä¾›ç½‘ç»œå®‰å…¨é¢†åŸŸåº”ç”¨æ¨¡å¼çš„å®Œæ•´å·¥å…·é›†æˆæŒ‡å—ã€‚

**ç›¸å…³æ–‡æ¡£**:
- [ç½‘ç»œå®‰å…¨åº”ç”¨æ¨¡å¼æ¸…å•](ç½‘ç»œå®‰å…¨åº”ç”¨æ¨¡å¼æ¸…å•.md)
- [å·¥å…·é›†æˆä¸é…ç½®æŒ‡å—](../å·¥å…·é›†æˆä¸é…ç½®æŒ‡å—.md)

---

## ğŸ¯ **ä¸€ã€Petriç½‘å·¥å…·é›†æˆ / Part 1: Petri Net Tools Integration**

### 1.1 CPN Toolsé›†æˆï¼ˆæ”»å‡»çŠ¶æ€æœºå»ºæ¨¡ï¼‰

**Pythoné›†æˆ**:
```python
class AttackStateMachine:
    def model_attack_sequence(self, attack_steps: list):
        """å»ºæ¨¡æ”»å‡»åºåˆ—"""
        # CPN Toolså»ºæ¨¡
        pass
```

### 1.2 ProVerifé›†æˆï¼ˆå®‰å…¨åè®®éªŒè¯ï¼‰

**å®‰è£…**:
```bash
wget https://github.com/proverif/proverif/releases/download/v2.05/proverif2.05.tar.gz
tar -xzf proverif2.05.tar.gz
cd proverif2.05
make
```

**Pythoné›†æˆ**:
```python
import subprocess

class ProVerifIntegration:
    def verify_security_protocol(self, protocol_file: str):
        """éªŒè¯å®‰å…¨åè®®"""
        cmd = ['proverif', protocol_file]
        result = subprocess.run(cmd, capture_output=True, text=True)
        return {'success': result.returncode == 0, 'output': result.stdout}
```

---

## ğŸ”§ **äºŒã€åŠ¨æ€å›¾è®ºå·¥å…·é›†æˆ / Part 2: Dynamic Graph Tools Integration**

### 2.1 NetworkXé›†æˆï¼ˆDDoSæ£€æµ‹ï¼‰

**Pythoné›†æˆ**:
```python
import networkx as nx

class DDoSDetector:
    def __init__(self):
        self.graph = nx.DiGraph()
    
    def detect_ddos(self, traffic_data: list):
        """æ£€æµ‹DDoSæ”»å‡»"""
        for source, target, volume in traffic_data:
            self.graph.add_edge(source, target, traffic=volume)
        
        # è¯†åˆ«é«˜æµé‡ç›®æ ‡
        high_traffic_targets = []
        for node in self.graph.nodes():
            in_edges = list(self.graph.in_edges(node, data=True))
            total_traffic = sum(edge[2]['traffic'] for edge in in_edges)
            if total_traffic > 1000:  # é˜ˆå€¼
                high_traffic_targets.append((node, total_traffic))
        
        return high_traffic_targets
```

### 2.2 Neo4jé›†æˆï¼ˆæ”»å‡»å›¾åˆ†æï¼‰

**Pythoné›†æˆ**:
```python
from neo4j import GraphDatabase

class AttackGraphAnalyzer:
    def __init__(self, uri: str, user: str, password: str):
        self.driver = GraphDatabase.driver(uri, auth=(user, password))
    
    def store_attack_path(self, attack_path: list):
        """å­˜å‚¨æ”»å‡»è·¯å¾„"""
        with self.driver.session() as session:
            for i in range(len(attack_path) - 1):
                session.run("""
                    MERGE (a:Node {id: $source})
                    MERGE (b:Node {id: $target})
                    MERGE (a)-[r:ATTACKS]->(b)
                """, source=attack_path[i], target=attack_path[i+1])
```

### 2.3 Suricataé›†æˆï¼ˆIDSï¼‰

**å®‰è£…**:
```bash
sudo apt-get install suricata
sudo suricata-update
```

**é…ç½®**:
```yaml
# suricata.yaml
default-rule-path: /var/lib/suricata/rules
rule-files:
  - botcc.rules
  - ciarmy.rules
```

---

## ğŸ”¬ **ä¸‰ã€æ‹“æ‰‘åˆ†æå·¥å…·é›†æˆ / Part 3: Topological Analysis Tools Integration**

### 3.1 GUDHIé›†æˆï¼ˆæµé‡å¼‚å¸¸æ£€æµ‹ï¼‰

**Pythoné›†æˆ**:
```python
from gudhi import RipsComplex

class TrafficAnomalyDetector:
    def detect_anomaly(self, traffic_features: np.ndarray):
        """æ£€æµ‹æµé‡å¼‚å¸¸"""
        rips_complex = RipsComplex(points=traffic_features, max_edge_length=5.0)
        persistence = rips_complex.create_simplex_tree(max_dimension=2).persistence()
        
        # æ£€æµ‹å¼‚å¸¸æ¨¡å¼
        h0_features = [p for dim, p in persistence if dim == 0]
        if len(h0_features) > threshold:
            return {'anomaly': True, 'features': h0_features}
        return {'anomaly': False}
```

---

## ğŸš€ **å››ã€Graph Transformerå’ŒPGNNå·¥å…·é›†æˆï¼ˆ2025æœ€æ–°ï¼‰/ Part 4: Graph Transformer and PGNN Tools Integration (2025 Latest)**

### 4.1 PyTorch Geometricé›†æˆï¼ˆGraph Transformerï¼‰

**å®‰è£…**:
```bash
pip install torch torch-geometric
```

**Pythoné›†æˆ**:
```python
import torch
import torch.nn as nn
from torch_geometric.data import Data
from torch_geometric.nn import TransformerConv

class SecurityAnomalyDetectorGTIntegration:
    """ç½‘ç»œå®‰å…¨å¼‚å¸¸æ£€æµ‹Graph Transformeré›†æˆ"""
    
    def __init__(self, input_dim, hidden_dim=128, num_layers=3, num_heads=8):
        self.model = self._build_model(input_dim, hidden_dim, num_layers, num_heads)
        self.anomaly_head = nn.Sequential(
            nn.Linear(hidden_dim, hidden_dim // 2),
            nn.ReLU(),
            nn.Linear(hidden_dim // 2, 1),
            nn.Sigmoid()
        )
    
    def _build_model(self, input_dim, hidden_dim, num_layers, num_heads):
        """æ„å»ºGraph Transformeræ¨¡å‹"""
        layers = []
        layers.append(TransformerConv(input_dim, hidden_dim, heads=num_heads))
        
        for _ in range(num_layers - 1):
            layers.append(TransformerConv(hidden_dim, hidden_dim, heads=num_heads))
        
        return nn.Sequential(*layers)
    
    def detect_anomalies(self, node_features, edge_index):
        """æ£€æµ‹å¼‚å¸¸"""
        data = Data(x=node_features, edge_index=edge_index)
        node_embeddings = self.model(data.x, data.edge_index)
        anomaly_scores = self.anomaly_head(node_embeddings)
        return anomaly_scores
```

### 4.2 PyTorché›†æˆï¼ˆPGNNï¼‰

**Pythoné›†æˆ**:
```python
import torch
import torch.nn as nn
import networkx as nx

class AttackPathPredictorPGNNIntegration:
    """æ”»å‡»è·¯å¾„é¢„æµ‹PGNNé›†æˆ"""
    
    def __init__(self, num_nodes, num_attack_types, hidden_dim=128):
        self.node_embedding = nn.Embedding(num_nodes, hidden_dim)
        self.attack_embedding = nn.Embedding(num_attack_types, hidden_dim)
        
        self.propagation_layers = nn.ModuleList([
            nn.Linear(hidden_dim, hidden_dim) for _ in range(3)
        ])
        
        self.path_head = nn.Sequential(
            nn.Linear(hidden_dim * 2, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, 1),
            nn.Sigmoid()
        )
    
    def predict_attack_path(self, attack_petri_net, node_features, attack_features, source, target):
        """é¢„æµ‹æ”»å‡»è·¯å¾„"""
        embeddings = {}
        for node in attack_petri_net.nodes():
            if attack_petri_net.nodes[node]['type'] == 'node':
                node_idx = attack_petri_net.nodes[node]['index']
                embeddings[node] = self.node_embedding(node_idx) + node_features[node_idx]
            else:
                attack_idx = attack_petri_net.nodes[node]['index']
                embeddings[node] = self.attack_embedding(attack_idx) + attack_features[attack_idx]
        
        # PGNNä¼ æ’­
        for layer in self.propagation_layers:
            new_embeddings = {}
            for node in attack_petri_net.nodes():
                neighbor_embeddings = [embeddings[n] for n in attack_petri_net.neighbors(node)]
                if neighbor_embeddings:
                    aggregated = torch.stack(neighbor_embeddings).mean(dim=0)
                    new_embeddings[node] = layer(aggregated)
                else:
                    new_embeddings[node] = embeddings[node]
            embeddings = new_embeddings
        
        # é¢„æµ‹æ”»å‡»è·¯å¾„æ¦‚ç‡
        source_emb = embeddings[source]
        target_emb = embeddings[target]
        pair_feat = torch.cat([source_emb, target_emb], dim=-1)
        path_prob = self.path_head(pair_feat)
        
        return path_prob
```

---

## ğŸ”„ **äº”ã€å®‰å…¨ä¸“ç”¨å·¥å…·é›†æˆ / Part 5: Security Tools Integration**

### 4.1 MulVALé›†æˆï¼ˆæ”»å‡»å›¾ç”Ÿæˆï¼‰

**å®‰è£…**:
```bash
wget https://github.com/risksense/mulval/releases/download/v1.1/mulval.tar.gz
tar -xzf mulval.tar.gz
cd mulval
make
```

### 4.2 Zeeké›†æˆï¼ˆç½‘ç»œç›‘æ§ï¼‰

**å®‰è£…**:
```bash
sudo apt-get install zeek
```

**Pythoné›†æˆ**:
```python
import subprocess

class ZeekIntegration:
    def analyze_pcap(self, pcap_file: str):
        """åˆ†æpcapæ–‡ä»¶"""
        cmd = ['zeek', '-r', pcap_file]
        result = subprocess.run(cmd, capture_output=True, text=True)
        return result.stdout
```

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¶é—´**: 2025å¹´1æœˆ  
**çŠ¶æ€**: âœ… å®Œæˆ
