# 操作系统应用模式清单 / OS Application Patterns

## 📚 概述

聚焦死锁预防、锁依赖、调度与资源管理，给出建模选择、决策树、典型案例与工具栈。

## 🎯 核心问题与建模选择

- 死锁/饥饿：Petri网（工作流网/抑制弧）+ 可达/活性/有界性。
- 锁依赖/优先级反转：动态图（锁依赖图、等待图）+ 谱/社区/路径。
- 调度公平性：Petri网+T不变量（循环）；或拓扑分析循环流。
- 资源泄漏/泄压：S-不变量守恒校验；展开检测并发冲突。

## 🔀 决策树（简版）

1) 是否需要形式化安全性证明？→ 是：Petri网；否：动态图监测。
2) 规模>1e5节点？→ 是：动态图增量/近似；否：Petri网+展开。
3) 关注循环/等待链？→ 拓扑/持久同调检测循环；或等待图最短阻塞链。
4) 实时监控？→ 流式锁依赖图 + 异常检测；离线验证补充Petri网。

## 🧩 典型案例

- 生产者-消费者：有界缓冲区 → Petri网可达/有界性。
- 读写锁：读多写一 → 工作流网 + 活性检查。
- 哲学家就餐 / 银行家算法：死锁预防 → S/T不变量 + 可达性。
- 文件系统锁顺序：锁图环检测 + 持久同调循环判定。

## 🛠 工具栈

- Petri网：CPN Tools / TLA+ / Spin / GreatSPN。
- 动态图：NetworkX/igraph；Flink/Kafka 流式锁图；Neo4j 查询等待链。
- 拓扑：Ripser/GUDHI 持久同调；Mapper 摘要锁依赖结构。

## 📦 产出物

- 决策树：模型/工具选择。
- 校验报告：可达性、活性、有界性、循环检测。
- 流式监控面板：锁依赖/等待链、谱漂移。
- 示例模型：CPN/TLA+/Promela 小例子。

## ✅ 后续补充

- 完整决策树（Mermaid）与锁依赖流式检测示例。
- 2-3个可运行的Petri网/Promela示例与验证脚本。
