# å°ºåº¦æ˜ å°„å…³ç³» / Scale Mapping Relations

## ğŸ“š **æ¦‚è¿° / Overview**

æœ¬æ–‡æ¡£æè¿°å°ºåº¦æ˜ å°„å…³ç³»çš„å®šä¹‰å’Œæ€§è´¨ã€‚å°ºåº¦æ˜ å°„æ˜¯ä¸åŒå°ºåº¦ç½‘ç»œé—´çš„ç»“æ„ä¿æŒæ˜ å°„ï¼Œæ˜¯å¤šå°ºåº¦ç½‘ç»œå»ºæ¨¡çš„æ ¸å¿ƒæ¦‚å¿µã€‚

---

## ğŸ“‘ **ç›®å½• / Table of Contents**

- [å°ºåº¦æ˜ å°„å…³ç³» / Scale Mapping Relations](#å°ºåº¦æ˜ å°„å…³ç³»--scale-mapping-relations)
  - [ğŸ“š **æ¦‚è¿° / Overview**](#-æ¦‚è¿°--overview)
  - [ğŸ“‘ **ç›®å½• / Table of Contents**](#-ç›®å½•--table-of-contents)
  - [ğŸ“ **å½¢å¼åŒ–å®šä¹‰ / Formal Definition**](#-å½¢å¼åŒ–å®šä¹‰--formal-definition)
    - [å®šä¹‰ 2.2 (å°ºåº¦æ˜ å°„ / Scale Mapping)](#å®šä¹‰-22-å°ºåº¦æ˜ å°„--scale-mapping)
  - [ğŸ”§ **æ˜ å°„æ€§è´¨ / Mapping Properties**](#-æ˜ å°„æ€§è´¨--mapping-properties)
  - [ğŸ’» **ç®—æ³•å®ç° / Algorithm Implementation**](#-ç®—æ³•å®ç°--algorithm-implementation)
  - [ğŸ“Š **å¤æ‚åº¦åˆ†æ / Complexity Analysis**](#-å¤æ‚åº¦åˆ†æ--complexity-analysis)
  - [ğŸ”— **ç›¸å…³é“¾æ¥ / Related Links**](#-ç›¸å…³é“¾æ¥--related-links)

---

## ğŸ“ **å½¢å¼åŒ–å®šä¹‰ / Formal Definition**

### å®šä¹‰ 2.2 (å°ºåº¦æ˜ å°„ / Scale Mapping)

**å°ºåº¦æ˜ å°„**æ˜¯ä¸åŒå°ºåº¦ç½‘ç»œé—´çš„ç»“æ„ä¿æŒæ˜ å°„ï¼š

$$F_{ij}: (V_i, E_i) \to (V_j, E_j)$$

---

## ğŸ”§ **æ˜ å°„æ€§è´¨ / Mapping Properties**

1. **åŒæ€æ˜ å°„ (Homomorphic Mapping)**: ä¿æŒç½‘ç»œç»“æ„å…³ç³»
   - **å®šä¹‰**: å¦‚æœå­˜åœ¨æ˜ å°„ $f: V_1 \to V_2$ï¼Œä½¿å¾—å¯¹äºæ‰€æœ‰è¾¹ $(u,v) \in E_1$ï¼Œéƒ½æœ‰ $(f(u), f(v)) \in E_2$ï¼Œåˆ™ç§° $f$ ä¸ºåŒæ€æ˜ å°„
   - **æ€§è´¨**: ä¿æŒè¾¹çš„å­˜åœ¨æ€§ï¼Œä½†ä¸ä¸€å®šä¿æŒè¾¹çš„å”¯ä¸€æ€§
   - **åº”ç”¨**: ç½‘ç»œç®€åŒ–ã€ç½‘ç»œå‹ç¼©ã€ç½‘ç»œæŠ½è±¡

2. **åŒæ„æ˜ å°„ (Isomorphic Mapping)**: ä¿æŒç½‘ç»œç»“æ„å®Œå…¨å¯¹åº”
   - **å®šä¹‰**: å¦‚æœå­˜åœ¨åŒå°„æ˜ å°„ $f: V_1 \to V_2$ï¼Œä½¿å¾— $(u,v) \in E_1$ å½“ä¸”ä»…å½“ $(f(u), f(v)) \in E_2$ï¼Œåˆ™ç§° $f$ ä¸ºåŒæ„æ˜ å°„
   - **æ€§è´¨**: ä¿æŒç½‘ç»œç»“æ„çš„å®Œå…¨å¯¹åº”ï¼ŒåŒ…æ‹¬èŠ‚ç‚¹å’Œè¾¹çš„æ•°é‡
   - **åº”ç”¨**: ç½‘ç»œåŒ¹é…ã€ç½‘ç»œè¯†åˆ«ã€ç½‘ç»œåˆ†ç±»

3. **åµŒå…¥æ˜ å°„ (Embedding Mapping)**: å°†å°å°ºåº¦ç½‘ç»œåµŒå…¥å¤§å°ºåº¦ç½‘ç»œ
   - **å®šä¹‰**: å¦‚æœå­˜åœ¨å•å°„æ˜ å°„ $f: V_1 \to V_2$ï¼Œä½¿å¾—å¯¹äºæ‰€æœ‰è¾¹ $(u,v) \in E_1$ï¼Œéƒ½æœ‰ $(f(u), f(v)) \in E_2$ï¼Œåˆ™ç§° $f$ ä¸ºåµŒå…¥æ˜ å°„
   - **æ€§è´¨**: å°å°ºåº¦ç½‘ç»œæ˜¯å¤§å°ºåº¦ç½‘ç»œçš„å­å›¾
   - **åº”ç”¨**: ç½‘ç»œåŒ…å«å…³ç³»ã€ç½‘ç»œå±‚æ¬¡ç»“æ„ã€ç½‘ç»œæ¼”åŒ–

4. **ä¿åº¦æ˜ å°„ (Degree-Preserving Mapping)**: ä¿æŒèŠ‚ç‚¹åº¦æ•°
   - **å®šä¹‰**: å¦‚æœæ˜ å°„ $f$ æ»¡è¶³å¯¹äºæ‰€æœ‰èŠ‚ç‚¹ $v \in V_1$ï¼Œéƒ½æœ‰ $\deg(v) = \deg(f(v))$ï¼Œåˆ™ç§° $f$ ä¸ºä¿åº¦æ˜ å°„
   - **æ€§è´¨**: ä¿æŒèŠ‚ç‚¹çš„è¿æ¥æ€§ç‰¹å¾
   - **åº”ç”¨**: ç½‘ç»œç²—ç²’åŒ–ã€ç½‘ç»œç®€åŒ–

5. **ä¿è·¯å¾„æ˜ å°„ (Path-Preserving Mapping)**: ä¿æŒè·¯å¾„ç»“æ„
   - **å®šä¹‰**: å¦‚æœæ˜ å°„ $f$ æ»¡è¶³å¯¹äºæ‰€æœ‰è·¯å¾„ $p$ åœ¨ $G_1$ ä¸­ï¼Œ$f(p)$ æ˜¯ $G_2$ ä¸­çš„è·¯å¾„ï¼Œåˆ™ç§° $f$ ä¸ºä¿è·¯å¾„æ˜ å°„
   - **æ€§è´¨**: ä¿æŒç½‘ç»œçš„è¿é€šæ€§å’Œè·¯å¾„ä¿¡æ¯
   - **åº”ç”¨**: è·¯ç”±ä¼˜åŒ–ã€ç½‘ç»œåˆ†æ

6. **ä¿ç¤¾åŒºæ˜ å°„ (Community-Preserving Mapping)**: ä¿æŒç¤¾åŒºç»“æ„
   - **å®šä¹‰**: å¦‚æœæ˜ å°„ $f$ æ»¡è¶³å¯¹äºæ‰€æœ‰ç¤¾åŒº $C$ åœ¨ $G_1$ ä¸­ï¼Œ$f(C)$ æ˜¯ $G_2$ ä¸­çš„ç¤¾åŒºï¼Œåˆ™ç§° $f$ ä¸ºä¿ç¤¾åŒºæ˜ å°„
   - **æ€§è´¨**: ä¿æŒç½‘ç»œçš„æ¨¡å—åŒ–ç»“æ„
   - **åº”ç”¨**: ç¤¾åŒºæ£€æµ‹ã€ç½‘ç»œåˆ†æ

---

## ğŸ“ **æ˜ å°„ç±»å‹è¯¦ç»†åˆ†æ / Detailed Analysis of Mapping Types**

### åŒæ€æ˜ å°„è¯¦ç»†åˆ†æ

**æ•°å­¦å®šä¹‰**:

è®¾ $G_1 = (V_1, E_1)$ å’Œ $G_2 = (V_2, E_2)$ æ˜¯ä¸¤ä¸ªå›¾ï¼Œæ˜ å°„ $f: V_1 \to V_2$ æ˜¯åŒæ€æ˜ å°„ï¼Œå¦‚æœï¼š
$$\forall (u,v) \in E_1: (f(u), f(v)) \in E_2$$

**æ€§è´¨**:
- ä¿æŒè¾¹çš„å­˜åœ¨æ€§
- å¯èƒ½å°†å¤šä¸ªèŠ‚ç‚¹æ˜ å°„åˆ°åŒä¸€ä¸ªèŠ‚ç‚¹
- å¯èƒ½ä¸¢å¤±æŸäº›è¾¹çš„ä¿¡æ¯

**ç®—æ³•å¤æ‚åº¦**:
- æ—¶é—´å¤æ‚åº¦: $O(|V_1| \cdot |V_2| + |E_1|)$
- ç©ºé—´å¤æ‚åº¦: $O(|V_1| + |V_2|)$

**åº”ç”¨åœºæ™¯**:
1. **ç½‘ç»œç®€åŒ–**: å°†å¤æ‚ç½‘ç»œç®€åŒ–ä¸ºæ›´ç®€å•çš„ç½‘ç»œ
2. **ç½‘ç»œå‹ç¼©**: å‡å°‘ç½‘ç»œè§„æ¨¡ï¼Œä¿æŒå…³é”®ç»“æ„
3. **ç½‘ç»œæŠ½è±¡**: æå–ç½‘ç»œçš„é«˜å±‚ç»“æ„

### åŒæ„æ˜ å°„è¯¦ç»†åˆ†æ

**æ•°å­¦å®šä¹‰**:

è®¾ $G_1 = (V_1, E_1)$ å’Œ $G_2 = (V_2, E_2)$ æ˜¯ä¸¤ä¸ªå›¾ï¼Œæ˜ å°„ $f: V_1 \to V_2$ æ˜¯åŒæ„æ˜ å°„ï¼Œå¦‚æœï¼š
- $f$ æ˜¯åŒå°„
- $\forall (u,v) \in E_1 \iff (f(u), f(v)) \in E_2$

**æ€§è´¨**:
- ä¿æŒç½‘ç»œç»“æ„çš„å®Œå…¨å¯¹åº”
- èŠ‚ç‚¹å’Œè¾¹çš„æ•°é‡ç›¸åŒ
- ç½‘ç»œç»“æ„å®Œå…¨ç›¸åŒ

**ç®—æ³•å¤æ‚åº¦**:
- æ—¶é—´å¤æ‚åº¦: $O(|V|!)$ (æœ€åæƒ…å†µ)
- ç©ºé—´å¤æ‚åº¦: $O(|V|)$

**åº”ç”¨åœºæ™¯**:
1. **ç½‘ç»œåŒ¹é…**: åˆ¤æ–­ä¸¤ä¸ªç½‘ç»œæ˜¯å¦ç›¸åŒ
2. **ç½‘ç»œè¯†åˆ«**: è¯†åˆ«ç½‘ç»œçš„ç»“æ„ç‰¹å¾
3. **ç½‘ç»œåˆ†ç±»**: åŸºäºç»“æ„å¯¹ç½‘ç»œè¿›è¡Œåˆ†ç±»

### åµŒå…¥æ˜ å°„è¯¦ç»†åˆ†æ

**æ•°å­¦å®šä¹‰**:

è®¾ $G_1 = (V_1, E_1)$ å’Œ $G_2 = (V_2, E_2)$ æ˜¯ä¸¤ä¸ªå›¾ï¼Œæ˜ å°„ $f: V_1 \to V_2$ æ˜¯åµŒå…¥æ˜ å°„ï¼Œå¦‚æœï¼š
- $f$ æ˜¯å•å°„
- $\forall (u,v) \in E_1: (f(u), f(v)) \in E_2$

**æ€§è´¨**:
- $G_1$ æ˜¯ $G_2$ çš„å­å›¾
- ä¿æŒç½‘ç»œçš„ç»“æ„å…³ç³»
- å¯èƒ½ä¸¢å¤±æŸäº›è¾¹çš„ä¿¡æ¯

**ç®—æ³•å¤æ‚åº¦**:
- æ—¶é—´å¤æ‚åº¦: $O(|V_1| \cdot |V_2| + |E_1|)$
- ç©ºé—´å¤æ‚åº¦: $O(|V_1| + |V_2|)$

**åº”ç”¨åœºæ™¯**:
1. **ç½‘ç»œåŒ…å«å…³ç³»**: åˆ¤æ–­ä¸€ä¸ªç½‘ç»œæ˜¯å¦åŒ…å«å¦ä¸€ä¸ªç½‘ç»œ
2. **ç½‘ç»œå±‚æ¬¡ç»“æ„**: æ„å»ºç½‘ç»œçš„å±‚æ¬¡ç»“æ„
3. **ç½‘ç»œæ¼”åŒ–**: åˆ†æç½‘ç»œçš„æ¼”åŒ–è¿‡ç¨‹

---

## ğŸ’» **ç®—æ³•å®ç° / Algorithm Implementation**

```python
import networkx as nx
from typing import Dict, Optional

class ScaleMapping:
    """å°ºåº¦æ˜ å°„ç®—æ³•å®ç°"""

    def __init__(self, source_network: nx.Graph, target_network: nx.Graph):
        self.source = source_network
        self.target = target_network
        self.mapping = {}

    def homomorphic_mapping(self) -> Dict:
        """åŒæ€æ˜ å°„"""
        mapping = {}

        # åŸºäºèŠ‚ç‚¹åº¦æ•°çš„æ˜ å°„
        source_degrees = dict(self.source.degree())
        target_degrees = dict(self.target.degree())

        # æŒ‰åº¦æ•°æ’åº
        source_sorted = sorted(source_degrees.items(), key=lambda x: x[1])
        target_sorted = sorted(target_degrees.items(), key=lambda x: x[1])

        # åˆ›å»ºæ˜ å°„
        for i, (source_node, _) in enumerate(source_sorted):
            if i < len(target_sorted):
                mapping[source_node] = target_sorted[i][0]

        return mapping

    def isomorphic_mapping(self) -> Optional[Dict]:
        """åŒæ„æ˜ å°„"""
        # ä½¿ç”¨NetworkXçš„åŒæ„æ£€æµ‹
        if nx.is_isomorphic(self.source, self.target):
            return nx.isomorphism.GraphMatcher(self.source, self.target).mapping
        return None

    def embedding_mapping(self) -> Dict:
        """åµŒå…¥æ˜ å°„"""
        mapping = {}

        # æ‰¾åˆ°ç›®æ ‡ç½‘ç»œä¸­çš„å­å›¾
        for source_node in self.source.nodes():
            # é€‰æ‹©ç›®æ ‡ç½‘ç»œä¸­ç›¸ä¼¼åº¦æœ€é«˜çš„èŠ‚ç‚¹
            best_match = None
            best_similarity = -1

            for target_node in self.target.nodes():
                similarity = self.calculate_structural_similarity(source_node, target_node)
                if similarity > best_similarity:
                    best_similarity = similarity
                    best_match = target_node

            mapping[source_node] = best_match

        return mapping

    def calculate_structural_similarity(self, node1: int, node2: int) -> float:
        """è®¡ç®—ç»“æ„ç›¸ä¼¼æ€§"""
        # åŸºäºå±€éƒ¨ç»“æ„è®¡ç®—ç›¸ä¼¼æ€§
        neighbors1 = set(self.source.neighbors(node1))
        neighbors2 = set(self.target.neighbors(node2))

        # Jaccardç›¸ä¼¼æ€§
        intersection = len(neighbors1 & neighbors2)
        union = len(neighbors1 | neighbors2)

        return intersection / union if union > 0 else 0.0
```

---

## ğŸ“Š **å¤æ‚åº¦åˆ†æ / Complexity Analysis**

- **æ—¶é—´å¤æ‚åº¦**: $O(|V|^2)$ å…¶ä¸­ $|V|$ æ˜¯èŠ‚ç‚¹æ•°
- **ç©ºé—´å¤æ‚åº¦**: $O(|V|)$

---

## ğŸ”— **ç›¸å…³é“¾æ¥ / Related Links**

- [å¤æ‚ç³»ç»Ÿä¸å¤šå°ºåº¦å»ºæ¨¡ä¸»ç›®å½•](../../README.md)
- [å¤šå°ºåº¦ç½‘ç»œæ¨¡å‹ç›®å½•](../README.md)
- [å¤šå°ºåº¦ç½‘ç»œå®šä¹‰](01-å¤šå°ºåº¦ç½‘ç»œå®šä¹‰.md)
- [å¤æ‚ç³»ç»Ÿå…ƒæ¨¡å‹](../../00-å¤æ‚ç³»ç»Ÿå…ƒæ¨¡å‹.md)

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**åˆ›å»ºæ—¶é—´**: 2025å¹´1æœˆ
**çŠ¶æ€**: âœ… **å·²å®Œæˆ**
