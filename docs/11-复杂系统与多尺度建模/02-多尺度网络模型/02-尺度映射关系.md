# å°ºåº¦æ˜ å°„å…³ç³» / Scale Mapping Relations

## ğŸ“š **æ¦‚è¿° / Overview**

æœ¬æ–‡æ¡£æè¿°å°ºåº¦æ˜ å°„å…³ç³»çš„å®šä¹‰å’Œæ€§è´¨ã€‚å°ºåº¦æ˜ å°„æ˜¯ä¸åŒå°ºåº¦ç½‘ç»œé—´çš„ç»“æ„ä¿æŒæ˜ å°„ï¼Œæ˜¯å¤šå°ºåº¦ç½‘ç»œå»ºæ¨¡çš„æ ¸å¿ƒæ¦‚å¿µã€‚

---

## ğŸ“‘ **ç›®å½• / Table of Contents**

- [å°ºåº¦æ˜ å°„å…³ç³» / Scale Mapping Relations](#å°ºåº¦æ˜ å°„å…³ç³»--scale-mapping-relations)
  - [ğŸ“š **æ¦‚è¿° / Overview**](#-æ¦‚è¿°--overview)
  - [ğŸ“‘ **ç›®å½• / Table of Contents**](#-ç›®å½•--table-of-contents)
  - [ğŸ“ **å½¢å¼åŒ–å®šä¹‰ / Formal Definition**](#-å½¢å¼åŒ–å®šä¹‰--formal-definition)
    - [å®šä¹‰ 2.2 (å°ºåº¦æ˜ å°„ / Scale Mapping)](#å®šä¹‰-22-å°ºåº¦æ˜ å°„--scale-mapping)
  - [ğŸ”§ **æ˜ å°„æ€§è´¨ / Mapping Properties**](#-æ˜ å°„æ€§è´¨--mapping-properties)
  - [ğŸ’» **ç®—æ³•å®ç° / Algorithm Implementation**](#-ç®—æ³•å®ç°--algorithm-implementation)
  - [ğŸ“Š **å¤æ‚åº¦åˆ†æ / Complexity Analysis**](#-å¤æ‚åº¦åˆ†æ--complexity-analysis)
  - [ğŸ”— **ç›¸å…³é“¾æ¥ / Related Links**](#-ç›¸å…³é“¾æ¥--related-links)

---

## ğŸ“ **å½¢å¼åŒ–å®šä¹‰ / Formal Definition**

### å®šä¹‰ 2.2 (å°ºåº¦æ˜ å°„ / Scale Mapping)

**å°ºåº¦æ˜ å°„**æ˜¯ä¸åŒå°ºåº¦ç½‘ç»œé—´çš„ç»“æ„ä¿æŒæ˜ å°„ï¼š

$$F_{ij}: (V_i, E_i) \to (V_j, E_j)$$

---

## ğŸ”§ **æ˜ å°„æ€§è´¨ / Mapping Properties**

1. **åŒæ€æ˜ å°„**: ä¿æŒç½‘ç»œç»“æ„å…³ç³»
2. **åŒæ„æ˜ å°„**: ä¿æŒç½‘ç»œç»“æ„å®Œå…¨å¯¹åº”
3. **åµŒå…¥æ˜ å°„**: å°†å°å°ºåº¦ç½‘ç»œåµŒå…¥å¤§å°ºåº¦ç½‘ç»œ

---

## ğŸ’» **ç®—æ³•å®ç° / Algorithm Implementation**

```python
import networkx as nx
from typing import Dict, Optional

class ScaleMapping:
    """å°ºåº¦æ˜ å°„ç®—æ³•å®ç°"""

    def __init__(self, source_network: nx.Graph, target_network: nx.Graph):
        self.source = source_network
        self.target = target_network
        self.mapping = {}

    def homomorphic_mapping(self) -> Dict:
        """åŒæ€æ˜ å°„"""
        mapping = {}

        # åŸºäºèŠ‚ç‚¹åº¦æ•°çš„æ˜ å°„
        source_degrees = dict(self.source.degree())
        target_degrees = dict(self.target.degree())

        # æŒ‰åº¦æ•°æ’åº
        source_sorted = sorted(source_degrees.items(), key=lambda x: x[1])
        target_sorted = sorted(target_degrees.items(), key=lambda x: x[1])

        # åˆ›å»ºæ˜ å°„
        for i, (source_node, _) in enumerate(source_sorted):
            if i < len(target_sorted):
                mapping[source_node] = target_sorted[i][0]

        return mapping

    def isomorphic_mapping(self) -> Optional[Dict]:
        """åŒæ„æ˜ å°„"""
        # ä½¿ç”¨NetworkXçš„åŒæ„æ£€æµ‹
        if nx.is_isomorphic(self.source, self.target):
            return nx.isomorphism.GraphMatcher(self.source, self.target).mapping
        return None

    def embedding_mapping(self) -> Dict:
        """åµŒå…¥æ˜ å°„"""
        mapping = {}

        # æ‰¾åˆ°ç›®æ ‡ç½‘ç»œä¸­çš„å­å›¾
        for source_node in self.source.nodes():
            # é€‰æ‹©ç›®æ ‡ç½‘ç»œä¸­ç›¸ä¼¼åº¦æœ€é«˜çš„èŠ‚ç‚¹
            best_match = None
            best_similarity = -1

            for target_node in self.target.nodes():
                similarity = self.calculate_structural_similarity(source_node, target_node)
                if similarity > best_similarity:
                    best_similarity = similarity
                    best_match = target_node

            mapping[source_node] = best_match

        return mapping

    def calculate_structural_similarity(self, node1: int, node2: int) -> float:
        """è®¡ç®—ç»“æ„ç›¸ä¼¼æ€§"""
        # åŸºäºå±€éƒ¨ç»“æ„è®¡ç®—ç›¸ä¼¼æ€§
        neighbors1 = set(self.source.neighbors(node1))
        neighbors2 = set(self.target.neighbors(node2))

        # Jaccardç›¸ä¼¼æ€§
        intersection = len(neighbors1 & neighbors2)
        union = len(neighbors1 | neighbors2)

        return intersection / union if union > 0 else 0.0
```

---

## ğŸ“Š **å¤æ‚åº¦åˆ†æ / Complexity Analysis**

- **æ—¶é—´å¤æ‚åº¦**: $O(|V|^2)$ å…¶ä¸­ $|V|$ æ˜¯èŠ‚ç‚¹æ•°
- **ç©ºé—´å¤æ‚åº¦**: $O(|V|)$

---

## ğŸ”— **ç›¸å…³é“¾æ¥ / Related Links**

- [å¤æ‚ç³»ç»Ÿä¸å¤šå°ºåº¦å»ºæ¨¡ä¸»ç›®å½•](../../README.md)
- [å¤šå°ºåº¦ç½‘ç»œæ¨¡å‹ç›®å½•](../README.md)
- [å¤šå°ºåº¦ç½‘ç»œå®šä¹‰](01-å¤šå°ºåº¦ç½‘ç»œå®šä¹‰.md)
- [å¤æ‚ç³»ç»Ÿå…ƒæ¨¡å‹](../../00-å¤æ‚ç³»ç»Ÿå…ƒæ¨¡å‹.md)

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**åˆ›å»ºæ—¶é—´**: 2025å¹´1æœˆ
**çŠ¶æ€**: âœ… **å·²å®Œæˆ**
