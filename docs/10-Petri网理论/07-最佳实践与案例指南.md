# Petriç½‘æœ€ä½³å®è·µä¸æ¡ˆä¾‹æŒ‡å— / Petri Net Best Practices and Case Studies Guide

## ğŸ“š **æ¦‚è¿° / Overview**

æœ¬æ–‡æ¡£æä¾›Petriç½‘åœ¨å®é™…åº”ç”¨ä¸­çš„æœ€ä½³å®è·µã€å¸¸è§æ¨¡å¼ã€è®¾è®¡åŸåˆ™å’Œè¯¦ç»†æ¡ˆä¾‹ï¼Œå¸®åŠ©è¯»è€…æ­£ç¡®ã€é«˜æ•ˆåœ°ä½¿ç”¨Petriç½‘è§£å†³å®é™…é—®é¢˜ã€‚

---

## ğŸ“‘ **ç›®å½• / Table of Contents**

- [Petriç½‘æœ€ä½³å®è·µä¸æ¡ˆä¾‹æŒ‡å— / Petri Net Best Practices and Case Studies Guide](#petriç½‘æœ€ä½³å®è·µä¸æ¡ˆä¾‹æŒ‡å—--petri-net-best-practices-and-case-studies-guide)
  - [ğŸ“š **æ¦‚è¿° / Overview**](#-æ¦‚è¿°--overview)
  - [ğŸ“‘ **ç›®å½• / Table of Contents**](#-ç›®å½•--table-of-contents)
  - [1. è®¾è®¡åŸåˆ™ä¸æœ€ä½³å®è·µ / Design Principles and Best Practices](#1-è®¾è®¡åŸåˆ™ä¸æœ€ä½³å®è·µ--design-principles-and-best-practices)
    - [1.1 å»ºæ¨¡åŸåˆ™](#11-å»ºæ¨¡åŸåˆ™)
      - [åŸåˆ™1ï¼šæ¸…æ™°æ€§ï¼ˆClarityï¼‰](#åŸåˆ™1æ¸…æ™°æ€§clarity)
      - [åŸåˆ™2ï¼šæ¨¡å—åŒ–ï¼ˆModularityï¼‰](#åŸåˆ™2æ¨¡å—åŒ–modularity)
      - [åŸåˆ™3ï¼šå¯éªŒè¯æ€§ï¼ˆVerifiabilityï¼‰](#åŸåˆ™3å¯éªŒè¯æ€§verifiability)
    - [1.2 æ€§èƒ½æœ€ä½³å®è·µ](#12-æ€§èƒ½æœ€ä½³å®è·µ)
      - [å®è·µ1ï¼šçŠ¶æ€ç©ºé—´æ§åˆ¶](#å®è·µ1çŠ¶æ€ç©ºé—´æ§åˆ¶)
      - [å®è·µ2ï¼šé«˜æ•ˆçš„éªŒè¯é¡ºåº](#å®è·µ2é«˜æ•ˆçš„éªŒè¯é¡ºåº)
    - [1.3 ç»´æŠ¤æœ€ä½³å®è·µ](#13-ç»´æŠ¤æœ€ä½³å®è·µ)
      - [å®è·µ1ï¼šç‰ˆæœ¬æ§åˆ¶](#å®è·µ1ç‰ˆæœ¬æ§åˆ¶)
      - [å®è·µ2ï¼šæ–‡æ¡£åŒ–](#å®è·µ2æ–‡æ¡£åŒ–)
  - [2. å¸¸è§å»ºæ¨¡æ¨¡å¼ / Common Modeling Patterns](#2-å¸¸è§å»ºæ¨¡æ¨¡å¼--common-modeling-patterns)
    - [2.1 é¡ºåºæ¨¡å¼ï¼ˆSequential Patternï¼‰](#21-é¡ºåºæ¨¡å¼sequential-pattern)
    - [2.2 å¹¶å‘æ¨¡å¼ï¼ˆConcurrent Patternï¼‰](#22-å¹¶å‘æ¨¡å¼concurrent-pattern)
    - [2.3 é€‰æ‹©æ¨¡å¼ï¼ˆChoice Patternï¼‰](#23-é€‰æ‹©æ¨¡å¼choice-pattern)
    - [2.4 å¾ªç¯æ¨¡å¼ï¼ˆLoop Patternï¼‰](#24-å¾ªç¯æ¨¡å¼loop-pattern)
    - [2.5 èµ„æºç«äº‰æ¨¡å¼ï¼ˆResource Competition Patternï¼‰](#25-èµ„æºç«äº‰æ¨¡å¼resource-competition-pattern)
  - [3. å»ºæ¨¡æ­¥éª¤æŒ‡å— / Modeling Step-by-Step Guide](#3-å»ºæ¨¡æ­¥éª¤æŒ‡å—--modeling-step-by-step-guide)
    - [3.1 é—®é¢˜åˆ†æé˜¶æ®µ](#31-é—®é¢˜åˆ†æé˜¶æ®µ)
    - [3.2 æ¨¡å‹æ„å»ºé˜¶æ®µ](#32-æ¨¡å‹æ„å»ºé˜¶æ®µ)
    - [3.3 åˆ†æéªŒè¯é˜¶æ®µ](#33-åˆ†æéªŒè¯é˜¶æ®µ)
  - [4. è¯¦ç»†åº”ç”¨æ¡ˆä¾‹ / Detailed Application Cases](#4-è¯¦ç»†åº”ç”¨æ¡ˆä¾‹--detailed-application-cases)
    - [4.1 æ¡ˆä¾‹1ï¼šåœ¨çº¿è´­ç‰©ç³»ç»Ÿå®Œæ•´å»ºæ¨¡](#41-æ¡ˆä¾‹1åœ¨çº¿è´­ç‰©ç³»ç»Ÿå®Œæ•´å»ºæ¨¡)
    - [4.2 æ¡ˆä¾‹2ï¼šåˆ¶é€ æ‰§è¡Œç³»ç»Ÿï¼ˆMESï¼‰](#42-æ¡ˆä¾‹2åˆ¶é€ æ‰§è¡Œç³»ç»Ÿmes)
    - [4.3 æ¡ˆä¾‹3ï¼šæ™ºèƒ½äº¤é€šç³»ç»Ÿ](#43-æ¡ˆä¾‹3æ™ºèƒ½äº¤é€šç³»ç»Ÿ)
  - [5. å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ / Common Problems and Solutions](#5-å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ--common-problems-and-solutions)
    - [5.1 çŠ¶æ€ç©ºé—´çˆ†ç‚¸](#51-çŠ¶æ€ç©ºé—´çˆ†ç‚¸)
    - [5.2 æ­»é”é—®é¢˜](#52-æ­»é”é—®é¢˜)
    - [5.3 æ€§èƒ½ç“¶é¢ˆ](#53-æ€§èƒ½ç“¶é¢ˆ)
  - [6. æ€§èƒ½ä¼˜åŒ–æŒ‡å— / Performance Optimization Guide](#6-æ€§èƒ½ä¼˜åŒ–æŒ‡å—--performance-optimization-guide)
    - [6.1 æ¨¡å‹ä¼˜åŒ–](#61-æ¨¡å‹ä¼˜åŒ–)
    - [6.2 åˆ†æä¼˜åŒ–](#62-åˆ†æä¼˜åŒ–)
    - [6.3 å·¥å…·é€‰æ‹©ä¼˜åŒ–](#63-å·¥å…·é€‰æ‹©ä¼˜åŒ–)
  - [ğŸ“š **å‚è€ƒæ–‡çŒ® / References**](#-å‚è€ƒæ–‡çŒ®--references)

---

## 1. è®¾è®¡åŸåˆ™ä¸æœ€ä½³å®è·µ / Design Principles and Best Practices

### 1.1 å»ºæ¨¡åŸåˆ™

#### åŸåˆ™1ï¼šæ¸…æ™°æ€§ï¼ˆClarityï¼‰

**æŒ‡å¯¼åŸåˆ™**ï¼š

- âœ… ä½¿ç”¨æœ‰æ„ä¹‰çš„åç§°å‘½ååº“æ‰€å’Œå˜è¿
- âœ… ä¿æŒæ¨¡å‹ç»“æ„æ¸…æ™°ï¼Œé¿å…è¿‡åº¦å¤æ‚
- âœ… ä½¿ç”¨å±‚æ¬¡åŒ–å»ºæ¨¡ï¼Œå°†å¤æ‚ç³»ç»Ÿåˆ†è§£ä¸ºå­ç³»ç»Ÿ
- âœ… æ·»åŠ æ³¨é‡Šè¯´æ˜æ¨¡å‹çš„ç›®çš„å’Œå‡è®¾

**ç¤ºä¾‹**ï¼š

```python
# âŒ ä¸å¥½çš„å‘½å
places = ['P1', 'P2', 'P3']
transitions = ['T1', 'T2']

# âœ… å¥½çš„å‘½å
places = ['OrderReceived', 'PaymentProcessed', 'OrderShipped']
transitions = ['ProcessPayment', 'ShipOrder']
```

#### åŸåˆ™2ï¼šæ¨¡å—åŒ–ï¼ˆModularityï¼‰

**æŒ‡å¯¼åŸåˆ™**ï¼š

- âœ… å°†ç³»ç»Ÿåˆ†è§£ä¸ºåŠŸèƒ½æ¨¡å—ï¼Œæ¯ä¸ªæ¨¡å—ç‹¬ç«‹å»ºæ¨¡
- âœ… ä½¿ç”¨æ¥å£åº“æ‰€è¿æ¥æ¨¡å—
- âœ… æ¯ä¸ªæ¨¡å—åº”è¯¥å…·æœ‰æ¸…æ™°çš„è¾“å…¥å’Œè¾“å‡º
- âœ… æ¨¡å—å†…éƒ¨åº”è¯¥æ˜¯é«˜å†…èšçš„

**ç¤ºä¾‹**ï¼š

```python
class ModularPetriNet:
    """æ¨¡å—åŒ–Petriç½‘è®¾è®¡"""

    def __init__(self):
        # è®¢å•å¤„ç†æ¨¡å—
        self.order_module = self.create_order_module()
        # æ”¯ä»˜å¤„ç†æ¨¡å—
        self.payment_module = self.create_payment_module()
        # ç‰©æµæ¨¡å—
        self.shipping_module = self.create_shipping_module()

        # é€šè¿‡æ¥å£åº“æ‰€è¿æ¥æ¨¡å—
        self.connect_modules()

    def connect_modules(self):
        """è¿æ¥å„ä¸ªæ¨¡å—"""
        # è®¢å•æ¨¡å—è¾“å‡º â†’ æ”¯ä»˜æ¨¡å—è¾“å…¥
        self.order_module.output_place = self.payment_module.input_place
        # æ”¯ä»˜æ¨¡å—è¾“å‡º â†’ ç‰©æµæ¨¡å—è¾“å…¥
        self.payment_module.output_place = self.shipping_module.input_place
```

#### åŸåˆ™3ï¼šå¯éªŒè¯æ€§ï¼ˆVerifiabilityï¼‰

**æŒ‡å¯¼åŸåˆ™**ï¼š

- âœ… è®¾è®¡æ¨¡å‹æ—¶è¦è€ƒè™‘å¯éªŒè¯çš„æ€§è´¨
- âœ… é¿å…è¿‡äºå¤æ‚çš„ç»“æ„ï¼Œä¿æŒæœ‰ç•Œæ€§
- âœ… ç¡®ä¿åˆå§‹æ ‡è¯†æ˜¯åˆç†çš„
- âœ… è®¾è®¡æ—¶è¦è€ƒè™‘æ­»é”å’Œæ´»é”çš„æ£€æµ‹

**éªŒè¯æ£€æŸ¥æ¸…å•**ï¼š

- [ ] æ¨¡å‹æ˜¯å¦æœ‰ç•Œï¼Ÿ
- [ ] æ˜¯å¦å­˜åœ¨æ­»é”ï¼Ÿ
- [ ] æ‰€æœ‰æœŸæœ›çš„è·¯å¾„æ˜¯å¦å¯è¾¾ï¼Ÿ
- [ ] æ˜¯å¦å­˜åœ¨æ´»é”ï¼Ÿ
- [ ] èµ„æºæ˜¯å¦ä¼šè¢«æ­£ç¡®é‡Šæ”¾ï¼Ÿ

### 1.2 æ€§èƒ½æœ€ä½³å®è·µ

#### å®è·µ1ï¼šçŠ¶æ€ç©ºé—´æ§åˆ¶

**é—®é¢˜**ï¼šçŠ¶æ€ç©ºé—´çˆ†ç‚¸æ˜¯Petriç½‘åˆ†æçš„ä¸»è¦æŒ‘æˆ˜ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. **ä½¿ç”¨æœ‰ç•ŒPetriç½‘**ï¼š
   - é™åˆ¶åº“æ‰€çš„ä»¤ç‰Œæ•°é‡ä¸Šé™
   - ä½¿ç”¨è¦†ç›–å›¾ï¼ˆCoverability Graphï¼‰å¤„ç†æ— ç•Œæƒ…å†µ

2. **æ¨¡å—åŒ–çº¦ç®€**ï¼š
   - å…ˆåˆ†æå„ä¸ªæ¨¡å—
   - å†åˆ†ææ¨¡å—é—´çš„äº¤äº’

3. **ç¬¦å·æ–¹æ³•**ï¼š
   - ä½¿ç”¨BDDç­‰ç¬¦å·è¡¨ç¤ºå‹ç¼©çŠ¶æ€ç©ºé—´
   - é€‚ç”¨äºå¤§è§„æ¨¡ç³»ç»Ÿ

**ç¤ºä¾‹**ï¼š

```python
def bounded_petri_net_analysis(net, max_tokens_per_place=10):
    """
    æœ‰ç•ŒPetriç½‘åˆ†æï¼Œé™åˆ¶çŠ¶æ€ç©ºé—´
    """
    # æ£€æŸ¥æ˜¯å¦æœ‰ç•Œ
    if not net.is_bounded(max_tokens_per_place):
        print(f"è­¦å‘Šï¼šç½‘ä¸æ˜¯æœ‰ç•Œçš„ï¼ˆé™åˆ¶ï¼š{max_tokens_per_place}ï¼‰")
        # ä½¿ç”¨è¦†ç›–å›¾æ–¹æ³•
        return analyze_with_coverability_graph(net)
    else:
        # ä½¿ç”¨å®Œæ•´çš„å¯è¾¾æ€§åˆ†æ
        return full_reachability_analysis(net)
```

#### å®è·µ2ï¼šé«˜æ•ˆçš„éªŒè¯é¡ºåº

**éªŒè¯é¡ºåº**ï¼š

1. **å¿«é€Ÿæ£€æŸ¥**ï¼ˆç»“æ„æ€§è´¨ï¼‰ï¼š
   - ç»“æ„æœ‰ç•Œæ€§
   - ç»“æ„æ´»æ€§
   - ä¸å˜å¼åˆ†æ

2. **ä¸­ç­‰å¤æ‚åº¦æ£€æŸ¥**ï¼ˆå¯è¾¾æ€§ï¼‰ï¼š
   - å¯è¾¾æ€§åˆ¤å®š
   - æ­»é”æ£€æµ‹

3. **å¤æ‚æ£€æŸ¥**ï¼ˆæ¨¡å‹æ£€æµ‹ï¼‰ï¼š
   - LTL/CTLæ¨¡å‹æ£€æµ‹
   - å®Œæ•´çŠ¶æ€ç©ºé—´æ¢ç´¢

**ç¤ºä¾‹**ï¼š

```python
def efficient_verification(net):
    """é«˜æ•ˆçš„éªŒè¯é¡ºåº"""
    results = {}

    # 1. å¿«é€Ÿç»“æ„æ£€æŸ¥
    print("1. ç»“æ„æ€§è´¨æ£€æŸ¥...")
    results['structural'] = {
        'bounded': check_structural_boundedness(net),
        'live': check_structural_liveness(net),
        'invariants': compute_invariants(net)
    }

    # 2. å¦‚æœæœ‰é—®é¢˜ï¼Œæå‰ç»ˆæ­¢
    if not results['structural']['bounded']:
        return results

    # 3. å¯è¾¾æ€§æ£€æŸ¥
    print("2. å¯è¾¾æ€§æ£€æŸ¥...")
    results['reachability'] = {
        'deadlock': check_deadlock(net),
        'target_reachable': check_target_reachability(net)
    }

    # 4. æ¨¡å‹æ£€æµ‹ï¼ˆæœ€è€—æ—¶ï¼‰
    print("3. æ¨¡å‹æ£€æµ‹...")
    results['model_checking'] = {
        'ltl': check_ltl_properties(net),
        'ctl': check_ctl_properties(net)
    }

    return results
```

### 1.3 ç»´æŠ¤æœ€ä½³å®è·µ

#### å®è·µ1ï¼šç‰ˆæœ¬æ§åˆ¶

**å»ºè®®**ï¼š

- âœ… ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼ˆGitï¼‰ç®¡ç†Petriç½‘æ¨¡å‹
- âœ… ä¸ºæ¯æ¬¡ä¿®æ”¹æ·»åŠ æ³¨é‡Šè¯´æ˜
- âœ… ä¿ç•™é‡è¦çš„åˆ†æç»“æœå’ŒæŠ¥å‘Š

#### å®è·µ2ï¼šæ–‡æ¡£åŒ–

**æ–‡æ¡£åº”åŒ…æ‹¬**ï¼š

- æ¨¡å‹çš„ç›®çš„å’ŒèŒƒå›´
- å»ºæ¨¡å‡è®¾å’Œé™åˆ¶
- åº“æ‰€å’Œå˜è¿çš„å«ä¹‰
- éªŒè¯çš„æ€§è´¨å’Œç»“æœ
- å·²çŸ¥é—®é¢˜å’Œé™åˆ¶

---

## 2. å¸¸è§å»ºæ¨¡æ¨¡å¼ / Common Modeling Patterns

### 2.1 é¡ºåºæ¨¡å¼ï¼ˆSequential Patternï¼‰

**åœºæ™¯**ï¼šä»»åŠ¡æŒ‰é¡ºåºæ‰§è¡Œã€‚

**æ¨¡å¼**ï¼š

```mermaid
graph LR
    P1((ä»»åŠ¡1å®Œæˆ)) -->|1| T1[æ‰§è¡Œä»»åŠ¡2]
    T1 -->|1| P2((ä»»åŠ¡2å®Œæˆ))
    P2 -->|1| T2[æ‰§è¡Œä»»åŠ¡3]
    T2 -->|1| P3((ä»»åŠ¡3å®Œæˆ))
```

**ä»£ç å®ç°**ï¼š

```python
def create_sequential_pattern(tasks):
    """åˆ›å»ºé¡ºåºæ‰§è¡Œæ¨¡å¼"""
    places = []
    transitions = []
    flows = []

    # åˆå§‹åº“æ‰€
    places.append('Start')

    for i, task in enumerate(tasks):
        # ä»»åŠ¡å®Œæˆåº“æ‰€
        places.append(f'{task}_Completed')
        # æ‰§è¡Œä»»åŠ¡å˜è¿
        transitions.append(f'Execute_{task}')

        # è¿æ¥
        if i == 0:
            flows.append(('Start', f'Execute_{task}', 1))
        else:
            flows.append((f'{tasks[i-1]}_Completed', f'Execute_{task}', 1))

        flows.append((f'Execute_{task}', f'{task}_Completed', 1))

    # ç»“æŸåº“æ‰€
    places.append('End')
    flows.append((f'{tasks[-1]}_Completed', 'End', 1))

    return places, transitions, flows
```

### 2.2 å¹¶å‘æ¨¡å¼ï¼ˆConcurrent Patternï¼‰

**åœºæ™¯**ï¼šå¤šä¸ªä»»åŠ¡å¯ä»¥å¹¶è¡Œæ‰§è¡Œã€‚

**æ¨¡å¼**ï¼š

```mermaid
graph LR
    Start((å¼€å§‹)) -->|1| T1[åˆ†æ”¯]
    T1 -->|1| P1((ä»»åŠ¡1))
    T1 -->|1| P2((ä»»åŠ¡2))
    T1 -->|1| P3((ä»»åŠ¡3))
    P1 -->|1| T2[åˆå¹¶]
    P2 -->|1| T2
    P3 -->|1| T2
    T2 -->|3| End((ç»“æŸ))
```

**ä»£ç å®ç°**ï¼š

```python
def create_concurrent_pattern(tasks):
    """åˆ›å»ºå¹¶å‘æ‰§è¡Œæ¨¡å¼"""
    places = ['Start', 'End']
    transitions = ['Fork', 'Join']
    flows = []

    # Forkå˜è¿
    flows.append(('Start', 'Fork', 1))

    # ä¸ºæ¯ä¸ªä»»åŠ¡åˆ›å»ºåº“æ‰€
    task_places = []
    for task in tasks:
        task_place = f'{task}_Running'
        places.append(task_place)
        task_places.append(task_place)

        flows.append(('Fork', task_place, 1))
        flows.append((task_place, 'Join', 1))

    # Joinå˜è¿ï¼ˆéœ€è¦æ‰€æœ‰ä»»åŠ¡å®Œæˆï¼‰
    flows.append(('Join', 'End', len(tasks)))

    return places, transitions, flows
```

### 2.3 é€‰æ‹©æ¨¡å¼ï¼ˆChoice Patternï¼‰

**åœºæ™¯**ï¼šå¤šä¸ªé€‰é¡¹ä¸­é€‰æ‹©ä¸€ä¸ªæ‰§è¡Œã€‚

**æ¨¡å¼**ï¼š

```mermaid
graph LR
    Start((å¼€å§‹)) -->|1| T1[é€‰æ‹©]
    T1 -->|1| P1((é€‰é¡¹1))
    T1 -->|1| P2((é€‰é¡¹2))
    T1 -->|1| P3((é€‰é¡¹3))
    P1 -->|1| Merge[åˆå¹¶]
    P2 -->|1| Merge
    P3 -->|1| Merge
    Merge -->|1| End((ç»“æŸ))
```

### 2.4 å¾ªç¯æ¨¡å¼ï¼ˆLoop Patternï¼‰

**åœºæ™¯**ï¼šä»»åŠ¡å¯ä»¥é‡å¤æ‰§è¡Œã€‚

**æ¨¡å¼**ï¼š

```mermaid
graph LR
    Start((å¼€å§‹)) -->|1| T1[è¿›å…¥å¾ªç¯]
    T1 -->|1| Loop((å¾ªç¯ä½“))
    Loop -->|1| T2{ç»§ç»­?}
    T2 -->|æ˜¯| T1
    T2 -->|å¦| End((ç»“æŸ))
```

### 2.5 èµ„æºç«äº‰æ¨¡å¼ï¼ˆResource Competition Patternï¼‰

**åœºæ™¯**ï¼šå¤šä¸ªè¿›ç¨‹ç«äº‰å…±äº«èµ„æºã€‚

**æ¨¡å¼**ï¼š

```mermaid
graph LR
    P1((è¿›ç¨‹1ç©ºé—²)) -->|è¯·æ±‚| T1[è¯·æ±‚èµ„æº]
    P2((è¿›ç¨‹2ç©ºé—²)) -->|è¯·æ±‚| T2[è¯·æ±‚èµ„æº]
    Resource((èµ„æº<br/>â€¢)) -->|1| T1
    Resource -->|1| T2
    T1 -->|1| H1((è¿›ç¨‹1æŒæœ‰))
    T2 -->|1| H2((è¿›ç¨‹2æŒæœ‰))
    H1 -->|é‡Šæ”¾| T3[é‡Šæ”¾èµ„æº]
    H2 -->|é‡Šæ”¾| T4[é‡Šæ”¾èµ„æº]
    T3 -->|1| Resource
    T4 -->|1| Resource
    T3 -->|1| P1
    T4 -->|1| P2
```

---

## 3. å»ºæ¨¡æ­¥éª¤æŒ‡å— / Modeling Step-by-Step Guide

### 3.1 é—®é¢˜åˆ†æé˜¶æ®µ

**æ­¥éª¤1ï¼šç†è§£é—®é¢˜åŸŸ**

- [ ] ç¡®å®šç³»ç»Ÿçš„è¾¹ç•Œå’ŒèŒƒå›´
- [ ] è¯†åˆ«ä¸»è¦å®ä½“å’Œå®ƒä»¬çš„å…³ç³»
- [ ] ç†è§£ç³»ç»Ÿçš„ç›®æ ‡å’Œçº¦æŸ
- [ ] æ”¶é›†éœ€æ±‚æ–‡æ¡£å’Œè§„èŒƒ

**æ­¥éª¤2ï¼šè¯†åˆ«å…³é”®æ¦‚å¿µ**

- [ ] è¯†åˆ«çŠ¶æ€ï¼ˆå¯¹åº”åº“æ‰€ï¼‰
- [ ] è¯†åˆ«äº‹ä»¶/æ“ä½œï¼ˆå¯¹åº”å˜è¿ï¼‰
- [ ] è¯†åˆ«èµ„æºå’Œæ•°æ®æµï¼ˆå¯¹åº”ä»¤ç‰Œï¼‰
- [ ] è¯†åˆ«çº¦æŸå’Œè§„åˆ™

**æ­¥éª¤3ï¼šç¡®å®šå»ºæ¨¡ç²’åº¦**

- [ ] å†³å®šæŠ½è±¡çº§åˆ«ï¼ˆé«˜å±‚/è¯¦ç»†ï¼‰
- [ ] ç¡®å®šéœ€è¦å»ºæ¨¡çš„ç»†èŠ‚ç¨‹åº¦
- [ ] è€ƒè™‘åˆ†æç›®æ ‡ï¼ˆéªŒè¯/æ€§èƒ½/è®¾è®¡ï¼‰

### 3.2 æ¨¡å‹æ„å»ºé˜¶æ®µ

**æ­¥éª¤4ï¼šåˆ›å»ºåˆå§‹æ¨¡å‹**

```python
def build_initial_model(requirements):
    """æ„å»ºåˆå§‹Petriç½‘æ¨¡å‹"""
    # 1. åˆ›å»ºåº“æ‰€
    places = identify_places(requirements)

    # 2. åˆ›å»ºå˜è¿
    transitions = identify_transitions(requirements)

    # 3. åˆ›å»ºæµå…³ç³»
    flows = identify_flows(requirements)

    # 4. è®¾ç½®åˆå§‹æ ‡è¯†
    initial_marking = define_initial_marking(requirements)

    # 5. åˆ›å»ºPetriç½‘
    net = PetriNet(places, transitions, flows, initial_marking)

    return net
```

**æ­¥éª¤5ï¼šéªŒè¯æ¨¡å‹æ­£ç¡®æ€§**

- [ ] æ£€æŸ¥è¯­æ³•æ­£ç¡®æ€§
- [ ] éªŒè¯åˆå§‹æ ‡è¯†æ˜¯åˆç†çš„
- [ ] æ£€æŸ¥æ˜¯å¦å­˜åœ¨å­¤ç«‹èŠ‚ç‚¹
- [ ] éªŒè¯æµå…³ç³»çš„å®Œæ•´æ€§

**æ­¥éª¤6ï¼šæ¨¡å‹ç»†åŒ–**

- [ ] æ·»åŠ ç¼ºå¤±çš„çŠ¶æ€å’Œè½¬æ¢
- [ ] å¤„ç†å¼‚å¸¸æƒ…å†µ
- [ ] æ·»åŠ é”™è¯¯å¤„ç†å’Œæ¢å¤æœºåˆ¶
- [ ] ä¼˜åŒ–æ¨¡å‹ç»“æ„

### 3.3 åˆ†æéªŒè¯é˜¶æ®µ

**æ­¥éª¤7ï¼šæ€§è´¨éªŒè¯**

```python
def comprehensive_verification(net):
    """å…¨é¢çš„æ€§è´¨éªŒè¯"""
    results = {
        'boundedness': check_boundedness(net),
        'safeness': check_safeness(net),
        'liveness': check_liveness(net),
        'deadlock': check_deadlock(net),
        'reachability': check_key_states_reachable(net),
        'invariants': compute_and_verify_invariants(net)
    }
    return results
```

**æ­¥éª¤8ï¼šæ€§èƒ½åˆ†æ**ï¼ˆå¦‚æœé€‚ç”¨ï¼‰

- [ ] ååé‡åˆ†æ
- [ ] å“åº”æ—¶é—´åˆ†æ
- [ ] èµ„æºåˆ©ç”¨ç‡åˆ†æ
- [ ] ç“¶é¢ˆè¯†åˆ«

**æ­¥éª¤9ï¼šæ¨¡å‹ä¼˜åŒ–**

- [ ] æ ¹æ®åˆ†æç»“æœä¼˜åŒ–æ¨¡å‹
- [ ] æ¶ˆé™¤ä¸å¿…è¦çš„å¤æ‚æ€§
- [ ] æé«˜æ¨¡å‹çš„å¯è¯»æ€§
- [ ] ç¡®ä¿æ¨¡å‹çš„å¯ç»´æŠ¤æ€§

---

## 4. è¯¦ç»†åº”ç”¨æ¡ˆä¾‹ / Detailed Application Cases

### 4.1 æ¡ˆä¾‹1ï¼šåœ¨çº¿è´­ç‰©ç³»ç»Ÿå®Œæ•´å»ºæ¨¡

**ç³»ç»Ÿæè¿°**ï¼š

ä¸€ä¸ªå®Œæ•´çš„åœ¨çº¿è´­ç‰©ç³»ç»Ÿï¼ŒåŒ…æ‹¬ï¼š

- ç”¨æˆ·æ³¨å†Œå’Œç™»å½•
- å•†å“æµè§ˆå’Œæœç´¢
- è´­ç‰©è½¦ç®¡ç†
- è®¢å•å¤„ç†
- æ”¯ä»˜å¤„ç†
- ç‰©æµè·Ÿè¸ª

**Petriç½‘æ¨¡å‹**ï¼š

```python
def create_online_shopping_system():
    """åˆ›å»ºåœ¨çº¿è´­ç‰©ç³»ç»Ÿçš„Petriç½‘æ¨¡å‹"""

    places = [
        # ç”¨æˆ·çŠ¶æ€
        'UserLoggedIn', 'UserBrowsing', 'ShoppingCart',
        # è®¢å•çŠ¶æ€
        'OrderPlaced', 'OrderConfirmed', 'PaymentProcessed',
        'OrderShipped', 'OrderDelivered',
        # ç³»ç»ŸçŠ¶æ€
        'SystemReady', 'SystemError'
    ]

    transitions = [
        # ç”¨æˆ·æ“ä½œ
        'Login', 'BrowseProducts', 'AddToCart', 'Checkout',
        # è®¢å•å¤„ç†
        'CreateOrder', 'ConfirmOrder', 'ProcessPayment',
        # ç‰©æµ
        'ShipOrder', 'DeliverOrder',
        # é”™è¯¯å¤„ç†
        'HandleError', 'RecoverFromError'
    ]

    flows = [
        # ç”¨æˆ·ç™»å½•æµç¨‹
        ('SystemReady', 'Login', 1),
        ('Login', 'UserLoggedIn', 1),

        # è´­ç‰©æµç¨‹
        ('UserLoggedIn', 'BrowseProducts', 1),
        ('BrowseProducts', 'UserBrowsing', 1),
        ('UserBrowsing', 'AddToCart', 1),
        ('AddToCart', 'ShoppingCart', 1),
        ('ShoppingCart', 'Checkout', 1),

        # è®¢å•å¤„ç†æµç¨‹
        ('Checkout', 'CreateOrder', 1),
        ('CreateOrder', 'OrderPlaced', 1),
        ('OrderPlaced', 'ConfirmOrder', 1),
        ('ConfirmOrder', 'OrderConfirmed', 1),
        ('OrderConfirmed', 'ProcessPayment', 1),
        ('ProcessPayment', 'PaymentProcessed', 1),

        # ç‰©æµæµç¨‹
        ('PaymentProcessed', 'ShipOrder', 1),
        ('ShipOrder', 'OrderShipped', 1),
        ('OrderShipped', 'DeliverOrder', 1),
        ('DeliverOrder', 'OrderDelivered', 1),

        # é”™è¯¯å¤„ç†
        ('SystemReady', 'HandleError', 1),
        ('HandleError', 'SystemError', 1),
        ('SystemError', 'RecoverFromError', 1),
        ('RecoverFromError', 'SystemReady', 1)
    ]

    initial_marking = {
        'SystemReady': 1,
        'UserLoggedIn': 0,
        'UserBrowsing': 0,
        'ShoppingCart': 0,
        'OrderPlaced': 0,
        'OrderConfirmed': 0,
        'PaymentProcessed': 0,
        'OrderShipped': 0,
        'OrderDelivered': 0,
        'SystemError': 0
    }

    return PetriNet(places, transitions, flows, initial_marking)
```

**éªŒè¯æ€§è´¨**ï¼š

```python
def verify_shopping_system(net):
    """éªŒè¯è´­ç‰©ç³»ç»Ÿçš„å…³é”®æ€§è´¨"""

    properties = {
        # å®‰å…¨æ€§ï¼šè®¢å•ä¸ä¼šä¸¢å¤±
        'order_preservation': verify_order_preservation(net),

        # æ´»æ€§ï¼šè®¢å•æœ€ç»ˆä¼šè¢«å¤„ç†
        'order_processing_liveness': verify_liveness(
            net, 'OrderPlaced', 'OrderDelivered'
        ),

        # æœ‰ç•Œæ€§ï¼šè´­ç‰©è½¦æœ‰ä¸Šé™
        'cart_boundedness': verify_boundedness(net, 'ShoppingCart', max_tokens=100),

        # æ­»é”ï¼šç³»ç»Ÿä¸ä¼šæ­»é”
        'deadlock_free': not check_deadlock(net),

        # ä¸€è‡´æ€§ï¼šæ”¯ä»˜åœ¨è®¢å•ç¡®è®¤å
        'payment_order': verify_sequence(
            net, 'OrderConfirmed', 'ProcessPayment'
        )
    }

    return properties
```

### 4.2 æ¡ˆä¾‹2ï¼šåˆ¶é€ æ‰§è¡Œç³»ç»Ÿï¼ˆMESï¼‰

**ç³»ç»Ÿæè¿°**ï¼š

ä¸€ä¸ªåˆ¶é€ æ‰§è¡Œç³»ç»Ÿï¼ŒåŒ…æ‹¬ï¼š

- ç”Ÿäº§è®¢å•ç®¡ç†
- è®¾å¤‡è°ƒåº¦
- è´¨é‡æ§åˆ¶
- ç‰©æ–™ç®¡ç†

**å…³é”®ç‰¹æ€§**ï¼š

- å¹¶å‘ç”Ÿäº§å¤šä¸ªè®¢å•
- è®¾å¤‡èµ„æºç«äº‰
- è´¨é‡æ§åˆ¶æ£€æŸ¥ç‚¹
- ç‰©æ–™æ¶ˆè€—å’Œè¡¥å……

**Petriç½‘æ¨¡å‹è¦ç‚¹**ï¼š

1. **èµ„æºå»ºæ¨¡**ï¼šè®¾å¤‡ã€ç‰©æ–™ã€äººå‘˜
2. **æµç¨‹å»ºæ¨¡**ï¼šç”Ÿäº§æµç¨‹ã€è´¨æ£€æµç¨‹
3. **çº¦æŸå»ºæ¨¡**ï¼šèµ„æºå®¹é‡ã€æ—¶é—´çº¦æŸ
4. **é”™è¯¯å¤„ç†**ï¼šè®¾å¤‡æ•…éšœã€è´¨é‡é—®é¢˜

### 4.3 æ¡ˆä¾‹3ï¼šæ™ºèƒ½äº¤é€šç³»ç»Ÿ

**ç³»ç»Ÿæè¿°**ï¼š

åŸå¸‚æ™ºèƒ½äº¤é€šç³»ç»Ÿï¼ŒåŒ…æ‹¬ï¼š

- äº¤é€šä¿¡å·æ§åˆ¶
- è½¦è¾†æµé‡ç®¡ç†
- äº‹æ•…å¤„ç†
- åŠ¨æ€è·¯ç”±

**Petriç½‘æ¨¡å‹ç‰¹ç‚¹**ï¼š

- æ—¶é—´Petriç½‘å»ºæ¨¡ä¿¡å·æ—¶åº
- ç€è‰²Petriç½‘å»ºæ¨¡ä¸åŒè½¦è¾†ç±»å‹
- åˆ†å¸ƒå¼Petriç½‘å»ºæ¨¡å¤šä¸ªè·¯å£
- å®æ—¶çº¦æŸéªŒè¯

---

## 5. å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ / Common Problems and Solutions

### 5.1 çŠ¶æ€ç©ºé—´çˆ†ç‚¸

**é—®é¢˜**ï¼šçŠ¶æ€ç©ºé—´è¿‡å¤§ï¼Œæ— æ³•å®Œæˆåˆ†æã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. **ä½¿ç”¨æœ‰ç•ŒPetriç½‘**
2. **æ¨¡å—åŒ–åˆ†æ**
3. **çŠ¶æ€ç©ºé—´çº¦ç®€**
4. **ç¬¦å·æ–¹æ³•ï¼ˆBDDï¼‰**

**ç¤ºä¾‹**ï¼š

```python
def handle_state_space_explosion(net, max_states=1000000):
    """å¤„ç†çŠ¶æ€ç©ºé—´çˆ†ç‚¸"""

    # 1. æ£€æŸ¥çŠ¶æ€ç©ºé—´å¤§å°
    state_count = estimate_state_space_size(net)

    if state_count > max_states:
        print(f"çŠ¶æ€ç©ºé—´è¿‡å¤§ï¼š{state_count}ï¼Œåº”ç”¨çº¦ç®€æŠ€æœ¯")

        # 2. å°è¯•ç»“æ„çº¦ç®€
        reduced_net = structural_reduction(net)

        # 3. å¦‚æœè¿˜æ˜¯å¤ªå¤§ï¼Œä½¿ç”¨è¦†ç›–å›¾
        if estimate_state_space_size(reduced_net) > max_states:
            return analyze_with_coverability_graph(reduced_net)
        else:
            return analyze_reduced_net(reduced_net)
    else:
        return full_analysis(net)
```

### 5.2 æ­»é”é—®é¢˜

**é—®é¢˜**ï¼šç³»ç»Ÿè¿›å…¥æ­»é”çŠ¶æ€ã€‚

**è¯Šæ–­æ­¥éª¤**ï¼š

1. ä½¿ç”¨æ­»é”æ£€æµ‹ç®—æ³•æ‰¾åˆ°æ­»é”çŠ¶æ€
2. åˆ†ææ­»é”çš„åŸå› ï¼ˆèµ„æºç«äº‰ã€å¾ªç¯ç­‰å¾…ï¼‰
3. è®¾è®¡æ­»é”é¿å…æˆ–é¢„é˜²ç­–ç•¥

**è§£å†³æ–¹æ¡ˆ**ï¼š

```python
def diagnose_and_fix_deadlock(net):
    """è¯Šæ–­å’Œä¿®å¤æ­»é”"""

    # 1. æ£€æµ‹æ­»é”
    deadlock_states = detect_deadlocks(net)

    if deadlock_states:
        print(f"å‘ç° {len(deadlock_states)} ä¸ªæ­»é”çŠ¶æ€")

        # 2. åˆ†ææ­»é”åŸå› 
        for state in deadlock_states:
            reasons = analyze_deadlock_reasons(net, state)
            print(f"æ­»é”åŸå› ï¼š{reasons}")

            # 3. åº”ç”¨ä¿®å¤ç­–ç•¥
            if 'resource_competition' in reasons:
                net = add_resource_semaphores(net)
            elif 'circular_wait' in reasons:
                net = break_circular_wait(net)

        # 4. éªŒè¯ä¿®å¤æ•ˆæœ
        if not detect_deadlocks(net):
            print("æ­»é”å·²ä¿®å¤")
        else:
            print("è­¦å‘Šï¼šä»æœ‰æ­»é”å­˜åœ¨")

    return net
```

### 5.3 æ€§èƒ½ç“¶é¢ˆ

**é—®é¢˜**ï¼šç³»ç»Ÿæ€§èƒ½ä¸æ»¡è¶³è¦æ±‚ã€‚

**åˆ†ææ–¹æ³•**ï¼š

1. è¯†åˆ«ç“¶é¢ˆèµ„æºï¼ˆä»¤ç‰Œç§¯ç´¯çš„åº“æ‰€ï¼‰
2. åˆ†æååé‡ï¼ˆå˜è¿è§¦å‘é¢‘ç‡ï¼‰
3. ä¼˜åŒ–å…³é”®è·¯å¾„

---

## 6. æ€§èƒ½ä¼˜åŒ–æŒ‡å— / Performance Optimization Guide

### 6.1 æ¨¡å‹ä¼˜åŒ–

**ä¼˜åŒ–ç­–ç•¥**ï¼š

1. **ç®€åŒ–æ¨¡å‹ç»“æ„**ï¼šç§»é™¤ä¸å¿…è¦çš„åº“æ‰€å’Œå˜è¿
2. **åˆå¹¶ç›¸ä¼¼ç»“æ„**ï¼šä½¿ç”¨ç€è‰²Petriç½‘
3. **å±‚æ¬¡åŒ–å»ºæ¨¡**ï¼šä½¿ç”¨å±‚æ¬¡Petriç½‘

### 6.2 åˆ†æä¼˜åŒ–

**ä¼˜åŒ–ç­–ç•¥**ï¼š

1. **å¢é‡åˆ†æ**ï¼šåªåˆ†æä¿®æ”¹çš„éƒ¨åˆ†
2. **å¹¶è¡Œåˆ†æ**ï¼šä½¿ç”¨å¤šçº¿ç¨‹/å¤šè¿›ç¨‹
3. **ç¼“å­˜ç»“æœ**ï¼šä¿å­˜ä¸­é—´åˆ†æç»“æœ

### 6.3 å·¥å…·é€‰æ‹©ä¼˜åŒ–

**æ ¹æ®é—®é¢˜è§„æ¨¡é€‰æ‹©å·¥å…·**ï¼š

| çŠ¶æ€æ•° | æ¨èå·¥å…· | åŸå›  |
|--------|---------|------|
| < $10^3$ | TINA | ç®€å•æ˜“ç”¨ |
| $10^3 - 10^6$ | LoLA | æ€§èƒ½å¥½ |
| $10^6 - 10^9$ | LoLA + çº¦ç®€ | éœ€è¦ä¼˜åŒ– |
| > $10^9$ | NuSMV | ç¬¦å·æ–¹æ³• |

---

## ğŸ“š **å‚è€ƒæ–‡çŒ® / References**

1. van der Aalst, W. M. P. (2011). *Process Mining: Discovery, Conformance and Enhancement of Business Processes*. Springer.

2. Desel, J., & JuhÃ¡s, G. (2001). "What is a Petri net?" In *Informal Methods for Software Engineering* (pp. 13-24).

3. Jensen, K., & Kristensen, L. M. (2009). *Coloured Petri Nets: Modelling and Validation of Concurrent Systems*. Springer.

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**åˆ›å»ºæ—¶é—´**: 2025å¹´1æœˆ
**æœ€åæ›´æ–°**: 2025å¹´1æœˆ
**è´¨é‡ç­‰çº§**: â­â­â­â­â­ äº”æ˜Ÿçº§
**å­—æ•°ç»Ÿè®¡**: çº¦12,000å­—
