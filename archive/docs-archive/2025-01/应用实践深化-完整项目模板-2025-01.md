# åº”ç”¨å®è·µæ·±åŒ– - å®Œæ•´é¡¹ç›®æ¨¡æ¿ / Application Practice Deepening - Complete Project Template

## ğŸ“š **æ¦‚è¿° / Overview**

æœ¬æ–‡æ¡£æä¾›PGTã€Emmaã€GraphGPTã€GPSã€Mamba2äº”ä¸ªä¸“é¢˜çš„å®Œæ•´é¡¹ç›®æ¨¡æ¿ï¼ŒåŒ…æ‹¬é¡¹ç›®ç»“æ„ã€ä»£ç æ¨¡æ¿ã€é…ç½®æ–‡ä»¶å’Œæ–‡æ¡£æ¨¡æ¿ã€‚

**åˆ›å»ºæ—¶é—´**: 2025å¹´1æœˆ
**çŠ¶æ€**: âœ… æŒç»­æ›´æ–°ä¸­
**ä¼˜å…ˆçº§**: ğŸ”´ P0 - æé«˜ä¼˜å…ˆçº§

---

## ğŸ“ **ä¸€ã€é¡¹ç›®ç»“æ„æ¨¡æ¿ / Project Structure Template**

### 1.1 æ ‡å‡†é¡¹ç›®ç»“æ„

```
project_name/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/              # åŸå§‹æ•°æ®
â”‚   â”œâ”€â”€ processed/        # å¤„ç†åçš„æ•°æ®
â”‚   â””â”€â”€ splits/           # æ•°æ®åˆ’åˆ†
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ pgt/              # PGTæ¨¡å‹
â”‚   â”œâ”€â”€ emma/             # Emmaæ¨¡å‹
â”‚   â”œâ”€â”€ graphgpt/         # GraphGPTæ¨¡å‹
â”‚   â”œâ”€â”€ gps/              # GPSæ¨¡å‹
â”‚   â””â”€â”€ mamba2/           # Mamba2æ¨¡å‹
â”œâ”€â”€ training/
â”‚   â”œâ”€â”€ trainers/         # è®­ç»ƒå™¨
â”‚   â”œâ”€â”€ configs/          # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ scripts/          # è®­ç»ƒè„šæœ¬
â”œâ”€â”€ evaluation/
â”‚   â”œâ”€â”€ metrics/          # è¯„ä¼°æŒ‡æ ‡
â”‚   â”œâ”€â”€ visualizations/   # å¯è§†åŒ–
â”‚   â””â”€â”€ reports/         # è¯„ä¼°æŠ¥å‘Š
â”œâ”€â”€ deployment/
â”‚   â”œâ”€â”€ docker/           # Dockeré…ç½®
â”‚   â”œâ”€â”€ k8s/             # Kubernetesé…ç½®
â”‚   â””â”€â”€ scripts/         # éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ unit/            # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ integration/     # é›†æˆæµ‹è¯•
â”‚   â””â”€â”€ performance/     # æ€§èƒ½æµ‹è¯•
â”œâ”€â”€ docs/                # æ–‡æ¡£
â”œâ”€â”€ scripts/             # å·¥å…·è„šæœ¬
â”œâ”€â”€ requirements.txt     # ä¾èµ–
â”œâ”€â”€ setup.py            # å®‰è£…é…ç½®
â””â”€â”€ README.md           # é¡¹ç›®è¯´æ˜
```

---

## ğŸ’» **äºŒã€ä»£ç æ¨¡æ¿ / Code Templates**

### 2.1 æ¨¡å‹å®šä¹‰æ¨¡æ¿

```python
"""
æ¨¡å‹å®šä¹‰æ¨¡æ¿
"""

import torch
import torch.nn as nn
from torch_geometric.nn import MessagePassing

class ModelTemplate(nn.Module):
    """æ¨¡å‹æ¨¡æ¿"""

    def __init__(self,
                 input_dim,
                 hidden_dim,
                 num_layers,
                 dropout=0.1):
        super(ModelTemplate, self).__init__()

        # è¾“å…¥æŠ•å½±
        self.input_proj = nn.Linear(input_dim, hidden_dim)

        # æ¨¡å‹å±‚
        self.layers = nn.ModuleList([
            ModelLayer(hidden_dim, dropout)
            for _ in range(num_layers)
        ])

        # è¾“å‡ºæŠ•å½±
        self.output_proj = nn.Linear(hidden_dim, hidden_dim)

    def forward(self, x, edge_index):
        """å‰å‘ä¼ æ’­"""
        x = self.input_proj(x)

        for layer in self.layers:
            x = layer(x, edge_index)

        x = self.output_proj(x)
        return x
```

### 2.2 è®­ç»ƒè„šæœ¬æ¨¡æ¿

```python
"""
è®­ç»ƒè„šæœ¬æ¨¡æ¿
"""

import torch
import torch.nn as nn
from torch.utils.data import DataLoader
from tqdm import tqdm

def train_epoch(model, dataloader, optimizer, criterion, device):
    """è®­ç»ƒä¸€ä¸ªepoch"""
    model.train()
    total_loss = 0.0

    for batch in tqdm(dataloader, desc="Training"):
        batch = batch.to(device)

        optimizer.zero_grad()
        output = model(batch.x, batch.edge_index)
        loss = criterion(output, batch.y)
        loss.backward()
        optimizer.step()

        total_loss += loss.item()

    return total_loss / len(dataloader)

def validate(model, dataloader, criterion, device):
    """éªŒè¯"""
    model.eval()
    total_loss = 0.0

    with torch.no_grad():
        for batch in dataloader:
            batch = batch.to(device)
            output = model(batch.x, batch.edge_index)
            loss = criterion(output, batch.y)
            total_loss += loss.item()

    return total_loss / len(dataloader)

def main():
    # é…ç½®
    config = load_config('config.yaml')

    # æ•°æ®
    train_loader = create_dataloader(config.train_data)
    val_loader = create_dataloader(config.val_data)

    # æ¨¡å‹
    model = create_model(config.model)
    model = model.to(config.device)

    # ä¼˜åŒ–å™¨
    optimizer = torch.optim.AdamW(
        model.parameters(),
        lr=config.learning_rate
    )

    # æŸå¤±å‡½æ•°
    criterion = nn.CrossEntropyLoss()

    # è®­ç»ƒ
    for epoch in range(config.num_epochs):
        train_loss = train_epoch(
            model, train_loader, optimizer, criterion, config.device
        )
        val_loss = validate(
            model, val_loader, criterion, config.device
        )

        print(f"Epoch {epoch+1}: Train Loss={train_loss:.4f}, Val Loss={val_loss:.4f}")

if __name__ == '__main__':
    main()
```

### 2.3 è¯„ä¼°è„šæœ¬æ¨¡æ¿

```python
"""
è¯„ä¼°è„šæœ¬æ¨¡æ¿
"""

import torch
from sklearn.metrics import accuracy_score, f1_score

def evaluate_model(model, dataloader, device):
    """è¯„ä¼°æ¨¡å‹"""
    model.eval()
    predictions = []
    labels = []

    with torch.no_grad():
        for batch in dataloader:
            batch = batch.to(device)
            output = model(batch.x, batch.edge_index)
            pred = output.argmax(dim=-1)
            predictions.extend(pred.cpu().numpy())
            labels.extend(batch.y.cpu().numpy())

    accuracy = accuracy_score(labels, predictions)
    f1 = f1_score(labels, predictions, average='macro')

    return {
        'accuracy': accuracy,
        'f1_score': f1
    }
```

---

## âš™ï¸ **ä¸‰ã€é…ç½®æ–‡ä»¶æ¨¡æ¿ / Configuration Templates**

### 3.1 YAMLé…ç½®æ¨¡æ¿

```yaml
# config.yaml
model:
  name: "PGT"
  input_dim: 768
  hidden_dim: 768
  num_layers: 12
  num_heads: 12
  dropout: 0.1

training:
  num_epochs: 100
  batch_size: 32
  learning_rate: 1e-4
  weight_decay: 0.01
  warmup_steps: 10000

data:
  train_path: "data/train.pt"
  val_path: "data/val.pt"
  test_path: "data/test.pt"
  num_workers: 8

device: "cuda"
seed: 42
```

### 3.2 ç¯å¢ƒé…ç½®æ¨¡æ¿

```bash
# .env
CUDA_VISIBLE_DEVICES=0
PYTHONPATH=/path/to/project
DATA_DIR=/path/to/data
MODEL_DIR=/path/to/models
LOG_DIR=/path/to/logs
```

---

## ğŸ³ **å››ã€Dockeræ¨¡æ¿ / Docker Templates**

### 4.1 Dockerfileæ¨¡æ¿

```dockerfile
FROM nvidia/cuda:11.8.0-runtime-ubuntu22.04

WORKDIR /app

# å®‰è£…ä¾èµ–
RUN apt-get update && apt-get install -y \
    python3.10 \
    python3-pip \
    && rm -rf /var/lib/apt/lists/*

# å¤åˆ¶ä¾èµ–æ–‡ä»¶
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# å¤åˆ¶ä»£ç 
COPY . .

# æš´éœ²ç«¯å£
EXPOSE 8000

# å¯åŠ¨å‘½ä»¤
CMD ["python", "app.py"]
```

### 4.2 docker-composeæ¨¡æ¿

```yaml
version: '3.8'

services:
  model-service:
    build: .
    ports:
      - "8000:8000"
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]
    environment:
      - MODEL_PATH=/models/model.pth
    volumes:
      - ./models:/models
    restart: unless-stopped
```

---

## ğŸ“ **äº”ã€æ–‡æ¡£æ¨¡æ¿ / Documentation Templates**

### 5.1 READMEæ¨¡æ¿

```markdown
# é¡¹ç›®åç§°

## æ¦‚è¿°
é¡¹ç›®ç®€è¦æè¿°

## åŠŸèƒ½ç‰¹æ€§
- ç‰¹æ€§1
- ç‰¹æ€§2
- ç‰¹æ€§3

## å®‰è£…
```bash
pip install -r requirements.txt
```

## ä½¿ç”¨æ–¹æ³•

```python
from models import Model
model = Model()
```

## æ–‡æ¡£

è¯¦ç»†æ–‡æ¡£è¯·å‚è€ƒ [docs/](docs/)

## è®¸å¯è¯

MIT License

```

### 5.2 APIæ–‡æ¡£æ¨¡æ¿

```markdown
# APIæ–‡æ¡£

## Modelç±»

### __init__(input_dim, hidden_dim, num_layers)
åˆå§‹åŒ–æ¨¡å‹

**å‚æ•°**:
- input_dim: è¾“å…¥ç»´åº¦
- hidden_dim: éšè—å±‚ç»´åº¦
- num_layers: å±‚æ•°

### forward(x, edge_index)
å‰å‘ä¼ æ’­

**å‚æ•°**:
- x: èŠ‚ç‚¹ç‰¹å¾
- edge_index: è¾¹ç´¢å¼•

**è¿”å›**:
- output: è¾“å‡ºç‰¹å¾
```

---

## ğŸ§ª **å…­ã€æµ‹è¯•æ¨¡æ¿ / Test Templates**

### 6.1 å•å…ƒæµ‹è¯•æ¨¡æ¿

```python
"""
å•å…ƒæµ‹è¯•æ¨¡æ¿
"""

import unittest
import torch
from models import ModelTemplate

class TestModel(unittest.TestCase):
    """æ¨¡å‹æµ‹è¯•"""

    def setUp(self):
        self.model = ModelTemplate(
            input_dim=128,
            hidden_dim=256,
            num_layers=3
        )

    def test_forward(self):
        """æµ‹è¯•å‰å‘ä¼ æ’­"""
        x = torch.randn(10, 128)
        edge_index = torch.randint(0, 10, (2, 20))
        output = self.model(x, edge_index)
        self.assertEqual(output.shape, (10, 256))

if __name__ == '__main__':
    unittest.main()
```

---

## ğŸ“Š **ä¸ƒã€ç›‘æ§æ¨¡æ¿ / Monitoring Templates**

### 7.1 æ—¥å¿—é…ç½®æ¨¡æ¿

```python
"""
æ—¥å¿—é…ç½®æ¨¡æ¿
"""

import logging
from pathlib import Path

def setup_logging(log_dir='logs'):
    """è®¾ç½®æ—¥å¿—"""
    log_dir = Path(log_dir)
    log_dir.mkdir(exist_ok=True)

    logging.basicConfig(
        level=logging.INFO,
        format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
        handlers=[
            logging.FileHandler(log_dir / 'app.log'),
            logging.StreamHandler()
        ]
    )

    return logging.getLogger(__name__)
```

---

## ğŸ“ **å…«ã€ä½¿ç”¨æŒ‡å— / Usage Guide**

### 8.1 å¿«é€Ÿå¼€å§‹

1. **å…‹éš†é¡¹ç›®**

```bash
git clone <repository_url>
cd project_name
```

1. **å®‰è£…ä¾èµ–**

```bash
pip install -r requirements.txt
```

1. **å‡†å¤‡æ•°æ®**

```bash
python scripts/prepare_data.py
```

1. **è®­ç»ƒæ¨¡å‹**

```bash
python training/train.py --config configs/default.yaml
```

1. **è¯„ä¼°æ¨¡å‹**

```bash
python evaluation/evaluate.py --model_path models/best_model.pth
```

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**åˆ›å»ºæ—¶é—´**: 2025å¹´1æœˆ
**çŠ¶æ€**: âœ… å®Œæˆ
