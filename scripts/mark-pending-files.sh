#!/bin/bash
# ä¸ºæ‰€æœ‰å¾…å®Œå–„æ–‡ä»¶æ·»åŠ æ ‡è®°
# ä½¿ç”¨æ–¹æ³•: bash scripts/mark-pending-files.sh

MARKER='âš ï¸ **çŠ¶æ€**: å¾…å®Œå–„
ğŸ“ **è¯´æ˜**: æœ¬æ–‡æ¡£ä¸ºæ·±åº¦æ”¹è¿›ç‰ˆæ¨¡æ¿ï¼Œå†…å®¹ä¸å®Œæ•´ï¼Œéœ€è¦æ ¹æ®é¡¹ç›®å®šä½è¡¥å……å®Œæ•´çš„ç†è®ºæ¢³ç†å†…å®¹ã€‚

**å¾…è¡¥å……å†…å®¹**:
- [ ] å®Œæ•´çš„ç†è®ºå®šä¹‰
- [ ] æ€§è´¨ä¸å®šç†
- [ ] å½¢å¼åŒ–è¯æ˜
- [ ] åº”ç”¨æ¡ˆä¾‹
- [ ] ä¸å…¶ä»–ç†è®ºçš„å…³ç³»

---'

echo "å¼€å§‹ä¸ºå¾…å®Œå–„æ–‡ä»¶æ·»åŠ æ ‡è®°..."

count=0
find docs -name "*-æ·±åº¦æ”¹è¿›ç‰ˆ-2025.md" -type f | while read file; do
    # æ£€æŸ¥æ˜¯å¦å·²æœ‰æ ‡è®°
    if ! grep -q "âš ï¸ \*\*çŠ¶æ€\*\*: å¾…å®Œå–„" "$file" 2>/dev/null; then
        # è·å–æ–‡ä»¶çš„ç¬¬ä¸€è¡Œï¼ˆæ ‡é¢˜ï¼‰
        first_line=$(head -n 1 "$file")
        
        # åˆ›å»ºä¸´æ—¶æ–‡ä»¶
        temp_file=$(mktemp)
        
        # å†™å…¥æ ‡é¢˜
        echo "$first_line" > "$temp_file"
        echo "" >> "$temp_file"
        # å†™å…¥æ ‡è®°
        echo "$MARKER" >> "$temp_file"
        echo "" >> "$temp_file"
        # å†™å…¥å‰©ä½™å†…å®¹ï¼ˆè·³è¿‡ç¬¬ä¸€è¡Œï¼‰
        tail -n +2 "$file" >> "$temp_file"
        
        # æ›¿æ¢åŸæ–‡ä»¶
        mv "$temp_file" "$file"
        
        count=$((count + 1))
        echo "å·²æ ‡è®°: $file"
    fi
done

echo "å®Œæˆï¼å…±æ ‡è®° $count ä¸ªæ–‡ä»¶ã€‚"
